<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>UltraMaster Vâˆ â€¢ Wealthverse Ultimate</title>
<meta name="description" content="SiÃªu Web3 â€¢ AI Agents 24/7 â€¢ Premium on-chain insights â€¢ QR thanh toÃ¡n 1 cháº¡m â€¢ Viral share.">
<meta property="og:title" content="UltraMaster Vâˆ â€¢ Wealthverse Ultimate">
<meta property="og:description" content="Web3 tá»± váº­n hÃ nh, theme sÃ¡ng/tá»‘i, tá»± cáº¥u hÃ¬nh, QR thanh toÃ¡n vÃ  viral sharing.">
<meta name="theme-color" content="#0b0f13">
<link rel="preconnect" href="https://cdn.jsdelivr.net">
<style>
/* ===== Design tokens (dark + feng-shui gold/green/purple) ===== */
:root{
  --bg:#0b0f13;--card:#0f141a;--line:#233041;--txt:#e9eef4;--mut:#a9b8c8;
  --gold:#ffd700;--green:#16a34a;--purple:#6d28d9;--danger:#ff4d4f;--ok:#16a34a;
  --pill:#0f1725;--btn:#ffd700;--btnTxt:#0b0f13;--ring:rgba(255,215,0,.25);
  --shadow:0 10px 30px rgba(0,0,0,.35), 0 0 0 1px rgba(255,255,255,.02) inset;
}
:root.light{
  --bg:#f6f9fc;--card:#ffffff;--line:#e2e8f0;--txt:#0b1020;--mut:#4a5568;
  --gold:#d4af37;--green:#0f7a2a;--purple:#5b21b6;--danger:#e11d48;--ok:#0f7a2a;
  --pill:#eef2f7;--btn:#d4af37;--btnTxt:#121212;--ring:rgba(212,175,55,.25);
  --shadow:0 10px 24px rgba(0,0,0,.08);
}
*{box-sizing:border-box}html,body{height:100%}
body{margin:0;background:
  radial-gradient(60% 140% at 50% -10%, rgba(109,40,217,.25),transparent 60%),
  linear-gradient(180deg, rgba(22,163,74,.12),transparent 40%),
  var(--bg);
color:var(--txt);font:16px/1.6 system-ui, -apple-system, Segoe UI, Roboto}
.wrap{max-width:1200px;margin:0 auto;padding:20px}
.card{background:var(--card);border:1px solid var(--line);border-radius:18px;padding:18px;box-shadow:var(--shadow);margin:12px 0;transition:.25s}
.card:hover{transform:translateY(-2px)}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}
.pill{display:inline-flex;align-items:center;gap:8px;padding:8px 14px;border:1px solid var(--line);border-radius:999px;background:var(--pill);color:var(--txt)}
.btn{display:inline-flex;align-items:center;gap:8px;border:0;border-radius:12px;padding:12px 16px;font-weight:700;background:var(--btn);color:var(--btnTxt);cursor:pointer;box-shadow:0 0 0 0 var(--ring);transition:.2s}
.btn:hover{transform:translateY(-1px);box-shadow:0 0 0 6px var(--ring)}
.btn.out{background:transparent;color:var(--txt);border:1px solid var(--line)}
.logo-dot{width:12px;height:12px;border-radius:50%;background:var(--gold);box-shadow:0 0 0 0 rgba(255,215,0,.7);animation:glow 1.8s infinite}
@keyframes glow{0%{box-shadow:0 0 0 0 rgba(255,215,0,.7)}70%{box-shadow:0 0 0 14px rgba(255,215,0,0)}100%{box-shadow:0 0 0 0 rgba(255,215,0,0)}}
.hero{position:relative;overflow:hidden}
.globe{width:300px;height:300px;border-radius:50%;background:conic-gradient(from 0deg, var(--purple) 0 25%, var(--gold) 25% 50%, var(--green) 50% 75%, var(--purple) 75% 100%);animation:spin 40s linear infinite;margin:auto}
@keyframes spin{to{transform:rotate(360deg)}}
.kpi{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(180px,1fr))}
.kbox{background:linear-gradient(180deg, rgba(255,215,0,.12), transparent 60%),var(--card);border:1px solid var(--line);border-radius:14px;padding:12px;text-align:center}
.now{font-size:22px;font-weight:800;color:var(--gold)}
.tag{display:inline-block;border:1px solid var(--line);border-radius:10px;padding:4px 10px;margin:4px 6px 0 0;color:var(--txt);opacity:.85;font-size:13px}
.badge{display:inline-flex;align-items:center;padding:6px 10px;border:1px solid var(--line);border-radius:10px;background:rgba(109,40,217,.12)}
.qr-wrap{display:grid;place-items:center;border:1px dashed var(--line);border-radius:14px;background:radial-gradient(120% 100% at 50% -30%, rgba(255,215,0,.12), transparent 60%),transparent}
.qr{width:180px;height:180px;border-radius:12px;background:#fff}
.paybtn{display:flex;justify-content:space-between;align-items:center;border:1px solid var(--line);border-radius:12px;padding:10px 12px;background:transparent;cursor:pointer}
.paybtn.active{outline:2px solid var(--gold);box-shadow:0 0 0 6px var(--ring)}
.copy{font-size:13px;border:1px dashed var(--line);border-radius:8px;padding:4px 10px;background:transparent;color:var(--txt);cursor:pointer}
.footer{padding:32px 0;text-align:center;color:var(--mut)}
small.muted{color:var(--mut)}
/* Chat mini */
.chatfab{position:fixed;right:16px;bottom:16px;z-index:50}
.chatwin{position:fixed;right:16px;bottom:80px;width:min(420px,95vw);max-height:75vh;display:none;flex-direction:column;background:var(--card);border:1px solid var(--line);border-radius:16px;overflow:hidden;z-index:49;box-shadow:var(--shadow)}
.chathead{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-bottom:1px solid var(--line)}
.chatbody{padding:12px;overflow:auto;display:flex;flex-direction:column;gap:8px}
.bubble{max-width:85%;padding:10px 14px;border:1px solid var(--line);border-radius:12px}
.bubble.me{align-self:flex-end;background:#102235}
.bubble.ai{align-self:flex-start;background:#101a11}
.chatinput{display:flex;gap:8px;padding:12px;border-top:1px solid var(--line)}
.chatinput input{flex:1;padding:10px;border-radius:10px;border:1px solid var(--line);background:transparent;color:var(--txt)}
.hidden{display:none}
.mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace}
@media(max-width:900px){.header-flex{display:grid;gap:16px}}
</style>
</head>
<body>
<div class="wrap" id="app">

  <!-- Top row -->
  <div class="row">
    <span class="pill"><span class="logo-dot"></span><b id="t_brand">UltraMaster Vâˆ</b></span>
    <span class="pill">ENS: <b id="ens">lightunfold.eth</b></span>
    <span class="pill">Heartbeat: <b id="hb">â€”</b></span>
    <button class="pill" id="openData">Data</button>
    <button class="pill" id="lang">VI/EN</button>
    <button class="pill" id="theme">ğŸŒ— Theme</button>
  </div>

  <!-- Hero -->
  <section class="card hero">
    <div class="header-flex">
      <div>
        <h1 id="brand">LightUnfold â€¢ UltraMaster Vâˆ Ultimate</h1>
        <div class="muted" id="tagline">Web3 SiÃªu Tá»± Váº­n HÃ nh â€“ AI Agents 24/7 â€¢ Má»Ÿ KhÃ³a Top 3 Onâ€‘Chain â€¢ Token Chá»n Lá»c Realtime</div>
        <div class="card" style="margin-top:12px">
          <b id="moto">â€œBiáº¿t Sá»›m â€“ Quyáº¿t Äá»‹nh Sá»›m â€“ TÃ i Lá»™c Sá»›m.â€</b><br>
          <small class="muted" id="motoDesc">Há»™i tá»¥: <b>KhÃ³a há»c tinh gá»n</b>, <b>PhÃ¢n tÃ­ch crypto realtime</b>, <b>AI há»i Ä‘Ã¡p</b>, <b>CÆ¡ há»™i sá»›m nháº¥t</b>.</small>
        </div>
        <div class="row" style="margin-top:12px">
          <a class="btn out" id="cta_binance" href="#" target="_blank" rel="noopener">Má»Ÿ Binance Miá»…n PhÃ­ â†—</a>
          <a class="btn out" id="cta_algos" href="#" target="_blank" rel="noopener">Má»Ÿ AlgosOne Miá»…n PhÃ­ â†—</a>
        </div>
      </div>
      <div>
        <div class="globe" aria-hidden="true"></div>
        <div class="muted" id="globeCap" style="text-align:center;margin-top:8px">TrÃ¡i Äáº¥t Onâ€‘Chain Â· Radar 24/7</div>
      </div>
    </div>
  </section>

  <!-- KPI -->
  <div class="kpi">
    <div class="kbox"><div class="muted" id="k1t">CÆ¡ Há»™i</div><div class="now" id="kOpps">0</div></div>
    <div class="kbox"><div class="muted" id="k2t">Cáº­p Nháº­t</div><div class="now" id="kUpd">â€”</div></div>
    <div class="kbox"><div class="muted" id="k3t">Äang Xem</div><div class="now" id="kLive">â€”</div></div>
    <div class="kbox"><div class="muted" id="k4t">Doanh Thu</div><div class="now">$<span id="kRev">0</span></div></div>
  </div>

  <!-- Top 3 Tokens -->
  <section class="card" id="secTop3">
    <h3 style="margin:0 0 10px" id="hTop3">â­ Top 3 Token Tiá»m NÄƒng HÃ´m Nay</h3>
    <div id="tokenPro" class="grid"></div>
  </section>

  <!-- Token Free -->
  <section class="card" id="secFree">
    <h3 style="margin:0 0 10px" id="hFree">ğŸ“Š Token Chá»n Lá»c (Miá»…n PhÃ­)</h3>
    <div id="tokenFree" class="grid"></div>
  </section>

  <!-- Há»c viá»‡n -->
  <section class="card" id="edu">
    <h3 style="margin:0 0 10px" id="hEdu">ğŸ“š Há»c Nhanh â€“ NFT Rewards</h3>
    <div class="grid" id="ebooks"></div>
  </section>

  <!-- CÆ¡ há»™i ná»•i báº­t -->
  <section class="card" id="secOpp">
    <div class="row" style="justify-content:space-between">
      <h3 style="margin:0" id="hOpp">ğŸ”¥ CÆ¡ Há»™i Ná»•i Báº­t (Multiâ€‘Chain)</h3>
      <div class="row"><span class="badge" id="scanMode">QuÃ©t: Onâ€‘Chain</span><button class="btn out" id="refreshNow">â†» LÃ m má»›i</button></div>
    </div>
    <div class="muted" id="ticker" style="margin:6px 0 10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">â€”</div>
    <div id="opps" class="grid"></div>
  </section>

  <!-- Premium Plans -->
  <section class="card" id="secPremium">
    <h3 style="margin:0 0 10px" id="hPlan">ğŸ’  Premium â€“ PhÃ¢n TÃ­ch ChuyÃªn SÃ¢u & Lá»™ TrÃ¬nh</h3>
    <div id="plans" class="grid"></div>
  </section>

  <!-- SuperGate: QR + Paywall -->
  <section class="card" id="supergate">
    <h3 style="margin:0 0 10px" id="hGate">ğŸ”“ SuperGate (Unlock Onâ€‘Chain)</h3>
    <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(280px,1fr))">
      <div class="card">
        <div class="grid" style="grid-template-columns:180px 1fr;align-items:center">
          <div class="qr-wrap"><img id="qr" class="qr" alt="QR"></div>
          <div>
            <div class="muted" id="gatePitch"><b>Thanh toÃ¡n nhá» Ä‘á»ƒ nháº­n mÃ£ má»Ÿ khÃ³a.</b></div>
            <div class="muted"><span id="addrLbl">Äá»‹a chá»‰/ID:</span> <span class="mono" id="payAddr">â€”</span></div>
            <div id="payList" class="grid" style="grid-template-columns:1fr"></div>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="grid" style="grid-template-columns:1fr">
          <div><label class="muted" id="bundleLbl">Chá»n gÃ³i</label><select id="bundleSel"></select></div>
          <div><label class="muted" id="codeLbl">MÃ£ má»Ÿ khÃ³a (sau thanh toÃ¡n)</label><input id="unlockCode" placeholder="Nháº­p mÃ£â€¦"></div>
          <div><input id="txhash" placeholder="(Tuá»³ chá»n) DÃ¡n TX Hash / ghi chÃº"></div>
          <div class="row"><button class="btn" id="doUnlock">Má»Ÿ khÃ³a</button><button class="btn out" id="remember">Nhá»› mÃ£</button></div>
          <div id="uMsg" class="muted"></div>
          <div class="muted" style="margin-top:8px" id="afterUnlockHint">Sau má»Ÿ khÃ³a, ná»™i dung Premium xuáº¥t hiá»‡n. MÃ£ Ä‘Æ°á»£c lÆ°u trÃªn thiáº¿t bá»‹.</div>
        </div>
      </div>
    </div>

    <div id="opened" class="hidden" style="margin-top:14px">
      <div class="row"><span class="pill" style="background:#11291a;border-color:#20452f;color:#bff5d0" id="unlockedLbl">âœ” ÄÃ£ má»Ÿ khÃ³a</span><button class="btn out" id="relock">KhoÃ¡ láº¡i</button></div>
      <div id="premium" class="grid" style="margin-top:12px"></div>
    </div>
  </section>

  <!-- Partners -->
  <section class="card" id="secPartners">
    <div class="grid">
      <div class="card" style="background:#1a1400;border-color:#6b4e00">
        <h4>AlgosOne â€“ Chiáº¿n lÆ°á»£c AI & cáº£nh bÃ¡o realtime</h4>
        <div class="muted">Copyâ€‘trading/chiáº¿n lÆ°á»£c tá»± Ä‘á»™ng cÃ³ rá»§i ro. CÃ¢n nháº¯c ká»¹ quy Ä‘á»‹nh & kháº©u vá»‹ rá»§i ro trÆ°á»›c khi dÃ¹ng.</div>
        <a class="btn" style="background:#ffb000;color:#1a1300;margin-top:8px" id="algosLink" href="#" target="_blank" rel="noopener">Má»Ÿ miá»…n phÃ­ â†—</a>
      </div>
      <div class="card" style="background:#1a1400;border-color:#6b4e00">
        <h4>BNB â€“ Há»‡ sinh thÃ¡i giao dá»‹ch</h4>
        <ul class="muted" style="margin:10px 0 0 18px">
          <li>Thanh khoáº£n sÃ¢u â€¢ phÃ­ cáº¡nh tranh</li><li>Báº£o máº­t nhiá»u lá»›p â€¢ 2FA</li><li>Há»‡ sinh thÃ¡i Earn â€¢ Launchpool</li>
        </ul>
        <a class="btn" style="background:#ffb000;color:#1a1300;margin-top:8px" id="bnbLink" href="#" target="_blank" rel="noopener">Má»Ÿ miá»…n phÃ­ â†—</a>
      </div>
    </div>
  </section>

  <!-- CTA cuá»‘i -->
  <section class="card" id="lastCTA">
    <h3 style="margin:0 0 8px" id="ctaH">ğŸš€ CÆ¡ há»™i nhanh â€“ Chá»§ Ä‘á»™ng Ä‘Ã³n láº¥y</h3>
    <div id="ctaD">Má»Ÿ khÃ³a hoáº·c má»Ÿ tÃ i khoáº£n miá»…n phÃ­ Ä‘á»ƒ Theo dÃµi â€“ PhÃ¢n tÃ­ch â€“ HÃ nh Ä‘á»™ng má»™t nÆ¡i.</div>
    <div class="row" style="margin-top:10px">
      <a class="btn" href="#supergate" id="ctaOpen">Má»Ÿ khÃ³a ngay</a>
      <a class="btn out" id="ctaB" href="#" target="_blank" rel="noopener">Má»Ÿ Binance Miá»…n PhÃ­ â†—</a>
      <a class="btn out" id="ctaA" href="#" target="_blank" rel="noopener">Má»Ÿ AlgosOne Miá»…n PhÃ­ â†—</a>
      <button class="btn out" id="shareMine">Chia sáº» liÃªn káº¿t cá»§a tÃ´i</button>
    </div>
  </section>

  <!-- Footer -->
  <button class="pill" id="goTop" style="position:fixed;left:16px;bottom:90px;z-index:10">â†‘ Top</button>
  <div class="footer">Â© <span id="year"></span> Wealthverse â€¢ <span id="autoLbl">Tá»± váº­n hÃ nh 24/7</span></div>
</div>

<!-- Floating share -->
<div class="row" style="position:fixed;right:16px;bottom:16px;gap:8px;z-index:9;background:var(--card);border:1px solid var(--line);border-radius:14px;padding:10px">
  <a id="sh_tg" target="_blank" title="Share Telegram">ğŸ“£</a>
  <a id="sh_x" target="_blank" title="Share X">ğ•</a>
  <a id="sh_fb" target="_blank" title="Share Facebook">f</a>
  <a id="sh_in" target="_blank" title="Share LinkedIn">in</a>
</div>

<!-- Chat mini -->
<button class="btn chatfab" id="openChat">ğŸ§  Chat AI 24/7</button>
<div class="chatwin" id="chat">
  <div class="chathead"><b id="chatH">AI TÃ i chÃ­nh</b><button class="btn out" id="closeChat">ÄÃ³ng</button></div>
  <div class="chatbody" id="chatBody"></div>
  <div class="chatinput">
    <input id="chatIn" placeholder="Há»i vá» token, káº¿ hoáº¡ch lá»‡nhâ€¦">
    <button class="btn" id="chatSend">Gá»­i</button>
  </div>
</div>

<!-- Modal data -->
<div id="dataModal" class="hidden" style="position:fixed;inset:0;background:rgba(0,0,0,.55);place-items:center;z-index:99">
  <div class="card" style="width:min(95vw,960px);height:min(85vh,760px);display:flex;flex-direction:column">
    <div class="row" style="justify-content:space-between"><b id="mTitle">Dá»¯ liá»‡u Premium Onâ€‘Chain</b><button class="btn out" id="closeData">ÄÃ³ng</button></div>
    <pre id="dataPre" style="flex:1;margin:0;padding:12px;overflow:auto;background:#0b0f13;color:#cfe0ef;border:1px solid var(--line);border-radius:12px"></pre>
  </div>
</div>

<!-- ===== Inline CONFIG (chá»‰ sá»­a khá»‘i nÃ y Ä‘á»ƒ thay Ä‘á»•i toÃ n site) ===== -->
<script id="SITE_CONFIG" type="application/json">
{
  "brand":"LightUnfold â€¢ UltraMaster Vâˆ Ultimate",
  "ens":"lightunfold.eth",
  "links":{
    "binance":"https://www.binance.com/vi/register?ref=GRO_20338_9V44N",
    "algos":"https://algosone.page.link/MbtR"
  },
  "payments":{
    "paypal":{"label":"PayPal","id":"vumumabada@gmail.com","qr":"https://api.qrserver.com/v1/create-qr-code/?size=320x320&data=paypal.me/vumumabada"},
    "vietcombank":{"label":"Vietcombank","id":"9567892030","note":"TRáº¦N VÄ‚N VÅ¨ â€¢ chuyá»ƒn khoáº£n ghi note email/tx"},
    "momo":{"label":"MoMo","id":"0567892030","qr":"https://api.qrserver.com/v1/create-qr-code/?size=320x320&data=MoMo:0567892030"},
    "eth":{"label":"ETH (ERCâ€‘20)","id":"0x54E15A7b6d4213beE87800432A151d794638E3C2"},
    "usdt":{"label":"USDT (ERCâ€‘20)","id":"0x5da80d0f7e2df3cb0aa73d6a942bbe36b046b8f0"}
  },
  "premium":{
    "unlock_code":"23061988",
    "plans":[
      {"id":"p9","title":"Starter","price":9,"desc":"Top 3 hÃ´m nay â€¢ vÃ¹ng quan sÃ¡t â€¢ checklist rá»§i ro."},
      {"id":"p19","title":"Pro","price":19,"desc":"Starter + ká»‹ch báº£n 2 chiá»u â€¢ má»©c vÃ´ hiá»‡u hÃ³a â€¢ template R:R."},
      {"id":"p29","title":"Master","price":29,"desc":"Pro + Ä‘a khung â€¢ tÃ¢m lÃ½ & dÃ²ng tiá»n â€¢ playbook nÃ¢ng cao."}
    ]
  },
  "i18n":{
    "vi":{
      "tagline":"Web3 SiÃªu Tá»± Váº­n HÃ nh â€“ AI Agents 24/7 â€¢ Má»Ÿ KhÃ³a Top 3 Onâ€‘Chain â€¢ Token Chá»n Lá»c Realtime",
      "moto":"â€œBiáº¿t Sá»›m â€“ Quyáº¿t Äá»‹nh Sá»›m â€“ TÃ i Lá»™c Sá»›m.â€",
      "globeCap":"TrÃ¡i Äáº¥t Onâ€‘Chain Â· Radar 24/7"
    },
    "en":{
      "brand":"LightUnfold â€¢ UltraMaster Vâˆ Ultimate",
      "tagline":"Autonomous Web3 â€“ AI Agents 24/7 â€¢ Unlock Top 3 Onâ€‘Chain â€¢ Curated Tokens Realtime",
      "moto":"â€œKnow Early â€“ Decide Early â€“ Prosper Early.â€",
      "globeCap":"Onâ€‘Chain Earth Â· 24/7 Radar"
    }
  }
}
</script>

<!-- ===== Core JS (no external keys; tá»± hÃ n gáº¯n + tá»± cáº¥u hÃ¬nh) ===== -->
<script>
(() => {
  const $ = s => document.querySelector(s), $$ = s => document.querySelectorAll(s);
  const state = { lang: (localStorage.getItem('lang') || (navigator.language||'vi')).toLowerCase().startsWith('vi') ? 'vi' : 'en',
                  theme: localStorage.getItem('theme') || 'dark',
                  points: Number(localStorage.getItem('points')||0), rev: Number(localStorage.getItem('rev')||0),
                  config: {} };

  // Load config
  try { state.config = JSON.parse(document.getElementById('SITE_CONFIG').textContent.trim()); }
  catch(e){ state.config = {}; console.error('CONFIG parse error', e); }

  // Theme
  function applyTheme(mode){ document.documentElement.classList.toggle('light', mode==='light'); localStorage.setItem('theme', mode); }
  applyTheme(state.theme);
  $('#theme')?.addEventListener('click', () => { state.theme = (state.theme==='dark'?'light':'dark'); applyTheme(state.theme); });

  // I18N minimal
  function t(k){ const lang = state.lang; const base = state.config.i18n?.[lang]||{}; return base[k] || (state.config.i18n?.vi||{})[k] || ''; }
  function applyI18N(){
    $('#brand').textContent = (state.lang==='vi'? state.config.brand : (state.config.i18n?.en?.brand || state.config.brand));
    $('#tagline').textContent = t('tagline');
    $('#moto').textContent = t('moto');
    $('#globeCap').textContent = t('globeCap');
    $('#autoLbl').textContent = (state.lang==='vi'?'Tá»± váº­n hÃ nh 24/7':'Alwaysâ€‘On 24/7');
  }
  $('#lang')?.addEventListener('click', ()=>{ state.lang = (state.lang==='vi'?'en':'vi'); localStorage.setItem('lang', state.lang); applyI18N(); });
  applyI18N();

  // Brand / ENS / Links
  $('#t_brand').textContent = 'UltraMaster Vâˆ';
  $('#ens').textContent = state.config.ens || 'lightunfold.eth';
  const L = state.config.links||{};
  const setHref = (id, url) => { const el = $(id); if (el && url) el.href = url; };
  setHref('#cta_binance', L.binance); setHref('#cta_algos', L.algos);
  setHref('#bnbLink', L.binance); setHref('#algosLink', L.algos);
  setHref('#ctaB', L.binance); setHref('#ctaA', L.algos);

  // Year / Top button
  $('#year').textContent = new Date().getFullYear();
  $('#goTop').onclick = () => window.scrollTo({top:0, behavior:'smooth'});

  // Viral share
  const u = new URL(location.href);
  const peer = localStorage.getItem('peer_id') || Math.random().toString(36).slice(2);
  localStorage.setItem('peer_id', peer);
  const base = location.origin + location.pathname;
  const myRef = `${base}?ref=${peer}&utm_source=share&utm_medium=viral&utm_campaign=ultramaster`;
  const t_enc = encodeURIComponent(document.title), u_enc = encodeURIComponent(myRef);
  $('#sh_tg').href = `https://t.me/share/url?url=${u_enc}&text=${t_enc}`;
  $('#sh_x').href  = `https://twitter.com/intent/tweet?text=${t_enc}&url=${u_enc}`;
  $('#sh_fb').href = `https://www.facebook.com/sharer/sharer.php?u=${u_enc}`;
  $('#sh_in').href = `https://www.linkedin.com/sharing/share-offsite/?url=${u_enc}`;
  $('#shareMine').onclick = async () => {
    try{
      if(navigator.share){ await navigator.share({title:document.title,text:'KhÃ¡m phÃ¡ UltraMaster',url:myRef}); }
      else { await navigator.clipboard.writeText(myRef); alert(state.lang==='vi'?'ÄÃ£ sao chÃ©p liÃªn káº¿t!':'Referral link copied!'); }
      state.points += 20; localStorage.setItem('points', state.points);
      if(state.points>=100) alert('NFT reward unlocked!');
    }catch(_){}
  };

  // KPI & heartbeat
  function beat(){ $('#hb').textContent = new Date().toLocaleTimeString(); $('#kUpd').textContent = new Date().toLocaleString(); $('#kLive').textContent = Intl.NumberFormat().format(Math.floor(performance.now()/1000)); }
  setInterval(beat, 1000); beat();
  $('#kRev').textContent = state.rev.toLocaleString();

  // Top3 / Free (placeholder renderers; cÃ³ thá»ƒ ná»‘i API sau)
  function cardToken(x){
    const el = document.createElement('div'); el.className='card';
    el.innerHTML = `<b>${x.symbol} â€¢ ${x.name}</b>
      <div class="muted">24h: ${x.pct24h > 0 ? '+' : ''}${x.pct24h}% â€¢ Cap: $${Intl.NumberFormat().format(x.cap)}</div>
      <div class="row" style="margin-top:8px"><a class="btn out" href="${x.link}" target="_blank" rel="noopener">Xem biá»ƒu Ä‘á»“</a>
      <button class="btn" data-sym="${x.symbol}">AI phÃ¢n tÃ­ch</button></div>`;
    el.querySelector('button').onclick = () => addBubble(`Xin phÃ¢n tÃ­ch nhanh ${x.symbol} khung 1D/4H, má»©c vÃ´ hiá»‡u hÃ³a vÃ  vÃ¹ng quan sÃ¡t.`, 'me');
    return el;
  }
  const sampleTop = [
    {symbol:'BTC', name:'Bitcoin', pct24h:0.8, cap:900000000000, link:'https://www.coingecko.com/en/coins/bitcoin'},
    {symbol:'ETH', name:'Ethereum', pct24h:1.2, cap:450000000000, link:'https://www.coingecko.com/en/coins/ethereum'},
    {symbol:'BNB', name:'BNB', pct24h:-0.4, cap:80000000000, link:'https://www.coingecko.com/en/coins/bnb'}
  ];
  const sampleFree = [
    {symbol:'ARB', name:'Arbitrum', pct24h:2.1, cap:3000000000, link:'https://www.coingecko.com/en/coins/arbitrum'},
    {symbol:'OP', name:'Optimism', pct24h:-1.3, cap:2800000000, link:'https://www.coingecko.com/en/coins/optimism'}
  ];
  const proWrap = $('#tokenPro'); sampleTop.forEach(t=>proWrap.appendChild(cardToken(t)));
  const freeWrap = $('#tokenFree'); sampleFree.forEach(t=>freeWrap.appendChild(cardToken(t)));

  // Há»c viá»‡n
  const ebooks = [
    {title:"Crypto 101 (Miá»…n phÃ­)", price:0, desc:"VÃ­ â€¢ báº£o máº­t â€¢ chu ká»³ â€¢ quáº£n trá»‹ vá»‘n â€¢ checklist khá»Ÿi Ä‘á»™ng."},
    {title:"DeFi Mastery ($10)", price:10, desc:"Yield â€¢ Lending â€¢ Perp â€” váº­n hÃ nh & tá»‘i Æ°u."},
    {title:"Risk & Psychology ($19)", price:19, desc:"Ká»· luáº­t â€¢ nháº­t kÃ½ lá»‡nh â€¢ khung R:R."}
  ];
  const edu = $('#ebooks');
  ebooks.forEach(b=>{
    const d = document.createElement('div'); d.className='card';
    d.innerHTML = `<b>${b.title}</b><div class="muted">${b.desc}</div>
                   <div class="row" style="margin-top:8px"><span class="tag">$${b.price}</span>
                   <button class="btn out">Äá»c thá»­</button></div>`;
    edu.appendChild(d);
  });

  // Opportunities (placeholder)
  $('#ticker').textContent = 'Quan sÃ¡t chu ká»³ â€¢ Tin tá»©c onâ€‘chain â€¢ TÃ­n hiá»‡u funding/oi â€¢ Smart money flowsâ€¦';
  const opps = $('#opps');
  ['L2 bridge spike','DEX volume surge','Stablecoin netflow'].forEach(k=>{
    const c = document.createElement('div'); c.className='card';
    c.innerHTML = `<b>${k}</b><div class="muted">Theo dÃµi Ä‘iá»u kiá»‡n kÃ­ch hoáº¡t â€¢ chá»‰ lÃ  gá»£i Ã½ â€“ khÃ´ng pháº£i khuyáº¿n nghá»‹.</div>`;
    opps.appendChild(c);
  });
  $('#refreshNow').onclick = () => { $('#kOpps').textContent = (+$('#kOpps').textContent || 0)+Math.ceil(Math.random()*3); $('#kUpd').textContent = new Date().toLocaleString(); };

  // Plans
  const plans = state.config.premium?.plans || [];
  const plansWrap = $('#plans');
  plans.forEach(p=>{
    const el = document.createElement('div'); el.className='card';
    el.innerHTML = `<b>${p.title}</b><div class="muted" style="min-height:42px">${p.desc}</div>
    <div class="row" style="margin-top:8px"><span class="tag">$${p.price}</span><button class="btn" data-plan="${p.id}">Chá»n</button></div>`;
    el.querySelector('button').onclick = ()=>{ $('#bundleSel').value = p.id; window.location.hash = '#supergate'; };
    plansWrap.appendChild(el);
  });

  // SuperGate payments
  const pay = state.config.payments||{};
  const payList = $('#payList');
  const qr = $('#qr'), payAddr = $('#payAddr');
  const bundleSel = $('#bundleSel'); plans.forEach(p=>{ const o=document.createElement('option'); o.value=p.id; o.textContent=`${p.title} â€“ $${p.price}`; bundleSel.appendChild(o); });
  function setQR(text){ qr.src = `https://api.qrserver.com/v1/create-qr-code/?size=320x320&data=${encodeURIComponent(text)}`; }
  function paintPays(){
    payList.innerHTML='';
    Object.entries(pay).forEach(([k,v])=>{
      const row = document.createElement('div'); row.className='paybtn'; row.role='button'; row.tabIndex=0;
      row.innerHTML = `<div><b>${v.label}</b><div class="muted mono">${v.id}</div></div><button class="copy" data-id="${v.id}">Copy</button>`;
      row.onclick = ()=> selectPay(k);
      row.querySelector('.copy').onclick = (e)=>{ e.stopPropagation(); navigator.clipboard.writeText(v.id); toast('ÄÃ£ copy'); };
      payList.appendChild(row);
    });
  }
  function selectPay(key){
    $$('.paybtn').forEach(x=>x.classList.remove('active'));
    const idx = Array.from(payList.children).findIndex(n => n.querySelector('.mono')?.textContent===pay[key].id);
    if(idx>-1) payList.children[idx].classList.add('active');
    payAddr.textContent = pay[key].id;
    setQR(pay[key].qr || pay[key].id);
  }
  function toast(msg){ const t=document.createElement('div'); t.className='pill'; t.textContent=msg; Object.assign(t.style,{position:'fixed',left:'50%',top:'16px',transform:'translateX(-50%)',zIndex:9999}); document.body.appendChild(t); setTimeout(()=>t.remove(),1500); }
  paintPays(); // default select first
  const firstKey = Object.keys(pay)[0]; if(firstKey) selectPay(firstKey);

  // Unlock
  const SECRET = String(state.config.premium?.unlock_code || '');
  $('#doUnlock').onclick = ()=>{
    const ok = (String($('#unlockCode').value||'').trim() === SECRET);
    const msg = ok ? (state.lang==='vi'?'Má»Ÿ khÃ³a thÃ nh cÃ´ng!':'Unlocked!') : (state.lang==='vi'?'Sai mÃ£.':'Wrong code.');
    $('#uMsg').textContent = msg;
    if(ok){ $('#opened').classList.remove('hidden'); localStorage.setItem('premium_unlocked','1'); addRevenue(plans.find(p=>p.id === $('#bundleSel').value)?.price || 0); paintPremium(); }
  };
  $('#remember').onclick = ()=>{ localStorage.setItem('remember_code',$('#unlockCode').value||''); toast('ÄÃ£ nhá»› mÃ£'); };
  $('#relock').onclick = ()=>{ $('#opened').classList.add('hidden'); localStorage.removeItem('premium_unlocked'); };
  if(localStorage.getItem('premium_unlocked')==='1') $('#opened').classList.remove('hidden');

  function paintPremium(){
    const box = $('#premium'); box.innerHTML='';
    ['Playbook Ä‘a khung','Checklist rá»§i ro','Báº£ng tÃ¢m lÃ½ & dÃ²ng tiá»n','Q&A theo lá»‹ch'].forEach(x=>{
      const c=document.createElement('div'); c.className='card'; c.innerHTML = `<b>${x}</b><div class="muted">Ná»™i dung hiá»ƒn thá»‹ sau má»Ÿ khÃ³a.</div>`; box.appendChild(c);
    });
  }
  function addRevenue(x){ state.rev = Math.max(0, state.rev + Number(x||0)); localStorage.setItem('rev', state.rev); $('#kRev').textContent = state.rev.toLocaleString(); }

  // Data modal
  const PREMIUM_DATA = { updated_at: new Date().toISOString(), alpha_feed: [], deals: [] };
  function openData(){ $('#dataPre').textContent = JSON.stringify(PREMIUM_DATA,null,2); $('#dataModal').classList.remove('hidden'); }
  $('#openData').onclick = openData;
  $('#closeData').onclick = () => $('#dataModal').classList.add('hidden');
  $('#dataModal').addEventListener('click', e => { if(e.target.id==='dataModal') $('#dataModal').classList.add('hidden'); });

  // Chat (no API key exposed; fallback smart replies)
  function addBubble(txt, who='ai'){ const b=document.createElement('div'); b.className='bubble '+(who==='me'?'me':'ai'); b.textContent=txt; $('#chatBody').appendChild(b); $('#chatBody').scrollTop = $('#chatBody').scrollHeight; }
  $('#openChat').onclick = ()=>{ $('#chat').style.display='flex'; if(!$('#chatBody').dataset.hi){ addBubble(state.lang==='vi'?'ChÃ o! TÃ´i lÃ  AI há»— trá»£ phÃ¢n tÃ­ch.':'Hi! I am the analysis helper.'); $('#chatBody').dataset.hi=1; } };
  $('#closeChat').onclick = ()=> $('#chat').style.display='none';
  $('#chatSend').onclick = ()=>{ const v=$('#chatIn').value.trim(); if(!v) return; addBubble(v,'me'); $('#chatIn').value=''; setTimeout(()=>addBubble('Máº¹o: xÃ¡c Ä‘á»‹nh vÃ¹ng quan sÃ¡t, má»©c vÃ´ hiá»‡u hÃ³a, tá»‰ lá»‡ R:R â‰¥ 2:1, vÃ  giá»›i háº¡n rá»§i ro â‰¤1%.','ai'),400); };

  // Selfâ€‘heal (khÃ´ng reload vÃ´ háº¡n): náº¿u widget lá»—i, render tá»‘i thiá»ƒu an toÃ n
  window.addEventListener('error', () => {
    try{ $('#plans')?.children.length || plans.forEach(p=>{ const e=document.createElement('div'); e.className='card'; e.textContent=p.title; $('#plans').appendChild(e); }); }catch(_){}
  });

  // Shortcuts
  $('#ctaOpen').onclick = ()=> location.hash = '#supergate';
})();
</script>
</body>
</html>
