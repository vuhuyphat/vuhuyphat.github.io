<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>UltraMaster VâˆÎ©Î›Î â€¢ Web3 Singularity</title>
<meta name="description" content="VâˆÎ©Î›Î: SuperGate má»Ÿ khoÃ¡ táº¡i chá»— â€¢ AI chat 24/7 â€¢ Top token realtime â€¢ QR thanh toÃ¡n â€¢ ViralShare.">
<meta property="og:title" content="UltraMaster VâˆÎ©Î›Î â€¢ Web3 Singularity">
<meta property="og:description" content="AI 24/7 â€¢ Token chá»n lá»c (free) + Top 3 premium â€¢ Binance & AlgosOne â€¢ ViralShare 2.0">
<meta property="og:type" content="website">
<meta name="theme-color" content="#0b0f13">
<style>
:root{
  /* Dark (phong thuá»·: Ä‘en than + lá»¥c ngá»c + vÃ ng dá»‹u) */
  --bg:#0b0f13; --card:#0f141a; --line:#1e2a3a; --txt:#e9eef4; --mut:#a9b8c8;
  --brand:#7dc1ff; --accent:#ffb000; --ok:#22c55e; --bad:#ff4d4f;
  --pill:#101825; --shadow:rgba(0,0,0,.35);
  --gold:#ffd88a; --jade:#1f6f5f; --leaf:#124e3b; --leaf2:#0c382a;

  /* Light (phong thuá»·: ngá»c bÃ­ch â€“ ngÃ  â€“ vÃ ng dá»‹u) */
  --l-bg:#f7faf8; --l-card:#ffffff; --l-line:#e6efe6; --l-txt:#0b0f13; --l-mut:#5d6b65;
  --l-brand:#2266dd; --l-accent:#ffb84d; --l-pill:#eef6ef; --l-gold:#f2c979; --l-jade:#6fbfa1;
}
*{box-sizing:border-box}html,body{margin:0;background:var(--bg);color:var(--txt);font:15px/1.6 system-ui,-apple-system,Segoe UI,Roboto}
a{color:var(--brand);text-decoration:none}
.wrap{max-width:1120px;margin:0 auto;padding:18px}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.pill{display:inline-flex;gap:8px;align-items:center;padding:6px 12px;border:1px solid var(--line);border-radius:999px;background:var(--pill);color:#cfe0ef}
.card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px;margin-top:12px}
.grid{display:grid;gap:14px;grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
.btn{display:inline-flex;gap:8px;align-items:center;background:var(--accent);color:#1a1300;border:0;border-radius:12px;padding:10px 14px;font-weight:800;cursor:pointer}
.btn.out{background:transparent;border:1px solid var(--line);color:var(--txt)}
.badge{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--line);border-radius:999px;padding:4px 10px}
.hidden{display:none}.mono{font-family:ui-monospace,SFMono-Regular,Consolas,monospace;word-break:break-all}
.footer{padding:28px 0;text-align:center;color:var(--mut)}
.marquee{white-space:nowrap;overflow:hidden}.marquee>div{display:inline-block;animation:mar 25s linear infinite}
@keyframes mar{from{transform:translateX(0)}to{transform:translateX(-50%)}}
.list .item{display:flex;gap:10px;align-items:flex-start;padding:10px 0;border-top:1px dashed var(--line)}
.score{min-width:64px;text-align:center;border:1px solid var(--line);border-radius:10px;padding:4px 6px;color:#ffdca8;background:#241a00}
.tag{display:inline-block;border:1px solid var(--line);border-radius:8px;padding:2px 8px;margin:2px 4px 0 0;color:#c9d6e2;font-size:12px}
.kpi{display:grid;gap:10px;grid-template-columns:repeat(auto-fit,minmax(160px,1fr))}
.kbox{background:linear-gradient(180deg,rgba(18,53,36,.3),transparent);border:1px solid var(--line);border-radius:12px;padding:10px}
.now{font-size:22px;font-weight:800}

/* HERO */
.hero{position:relative;border:1px solid var(--line);border-radius:18px;overflow:hidden;background:
 radial-gradient(70% 140% at 50% -10%, rgba(41,93,64,.35), transparent),
 radial-gradient(80% 120% at 50% 10%, rgba(21,58,40,.25), transparent),
 linear-gradient(180deg, rgba(22,54,37,.12), transparent)}
.ribbon{position:absolute;inset:auto -30% -10% -30%;height:140px;background:
 linear-gradient(90deg,rgba(52,115,84,.18),rgba(13,63,45,.05),rgba(52,115,84,.18));filter:blur(18px);transform:rotate(-2deg)}
.logo-hero{display:flex;align-items:center;gap:8px}
.logo-dot{width:12px;height:12px;border-radius:50%;background:var(--accent);box-shadow:0 0 0 0 rgba(255,176,0,.6);animation:pulse 1.6s infinite}
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(255,176,0,.5)}70%{box-shadow:0 0 0 12px rgba(255,176,0,0)}100%{box-shadow:0 0 0 0 rgba(255,176,0,0)}}
.hero-cta{display:grid;gap:10px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}

/* Globe */
.header-flex{display:grid;grid-template-columns:1.2fr .8fr;gap:14px;align-items:center}
@media (max-width:900px){.header-flex{grid-template-columns:1fr}}
.globe{width:min(260px,60vw);aspect-ratio:1;border-radius:50%;margin:auto;position:relative;box-shadow:inset 0 0 30px rgba(0,0,0,.5),0 18px 34px var(--shadow)}
.sphere{position:absolute;inset:0;border-radius:50%;
  background:radial-gradient(circle at 40% 35%, #6ec1ff 0%, #2f80ed 44%, #0d4aaa 65%, #05224e 100%)}
.map{position:absolute;inset:0;border-radius:50%;
  background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400"><g fill="%23ffd77a" opacity="0.75"><path d="M100 150l30-10 20 10 8 14-6 12-18 7-24-6-10-11z"/><circle cx="520" cy="140" r="58"/></g></svg>');
  background-size:200% 100%;animation:spin 18s linear infinite;mix-blend-mode:screen;filter:contrast(120%)}
.moon{position:absolute;top:8%;left:50%;width:16px;height:16px;border-radius:50%;
  background:radial-gradient(circle at 30% 30%, #fff7d1, #f2c979);
  box-shadow:0 0 12px 4px rgba(242,201,121,.45);animation:orbit 6s linear infinite}
@keyframes spin{from{background-position:0 0}to{background-position:-200% 0}}
@keyframes orbit{from{transform:rotate(0deg) translateX(110px) rotate(0)}to{transform:rotate(360deg) translateX(110px) rotate(-360deg)}}
.ticker3{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;margin-top:8px}
.ticker3 .chip{border:1px dashed var(--line);border-radius:999px;padding:4px 10px}

/* Shop / cards */
.shop-card{padding:14px;border:1px solid var(--line);border-radius:12px;background:#0e1720}
.shop-card .note{color:#9fb3c8}
.price{font-weight:800}

/* SuperGate & Payments */
.paygrid{display:grid;gap:12px;grid-template-columns:1.2fr 1fr}
@media(max-width:900px){.paygrid{grid-template-columns:1fr}}
.qrbox{display:flex;gap:12px}
.qr{width:140px;height:140px;border-radius:12px;border:1px solid var(--line);background:#000}
.paymethods{display:flex;gap:8px;flex-wrap:wrap}
.paybtn{border:1px solid var(--line);background:var(--pill);color:var(--txt);border-radius:999px;padding:6px 10px;cursor:pointer}
.paybtn.act{outline:2px solid var(--accent);background:#1b2536}
.copy{cursor:pointer}

/* Chat */
.chatfab{position:fixed;right:16px;bottom:16px;z-index:50}
.chatwin{position:fixed;right:16px;bottom:80px;width:min(380px,92vw);max-height:70vh;display:none;flex-direction:column;background:var(--card);border:1px solid var(--line);border-radius:14px;overflow:hidden;z-index:60}
.chathead{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border-bottom:1px solid var(--line)}
.chatbody{padding:10px;overflow:auto}
.chatinput{display:flex;gap:6px;padding:10px;border-top:1px solid var(--line)}
.chatinput input{flex:1} .bubble{padding:8px 10px;border:1px solid var(--line);border-radius:10px;margin:6px 0}
.bubble.me{background:#122033} .bubble.ai{background:#121a12}

/* Footer CTA (xanh á»Ÿ trÃªn + láº·p á»Ÿ dÆ°á»›i) */
.footer-cta{border:1px dashed var(--line);border-radius:14px;padding:12px;background:linear-gradient(180deg,rgba(18,53,36,.3),transparent)}
.footer-cta.full{border:0;background:
  linear-gradient(180deg, rgba(18,53,36,.85), rgba(10,24,18,.9)),
  radial-gradient(120% 80% at 50% -10%, rgba(34,115,86,.35), transparent 60%);
  color:#dff7ea}

/* Light theme */
.light{--bg:var(--l-bg);--card:var(--l-card);--line:var(--l-line);--txt:var(--l-txt);--mut:var(--l-mut);
  --brand:var(--l-brand);--accent:var(--l-accent);--pill:var(--l-pill);--gold:var(--l-gold)}
.light .shop-card{background:#f7faf8}
.light .hero{background:
 radial-gradient(70% 140% at 50% -10%, rgba(140,205,180,.28), transparent),
 radial-gradient(80% 120% at 50% 10%, rgba(200,235,220,.25), transparent),
 linear-gradient(180deg, rgba(230,245,236,.6), transparent)}
.light .globe .sphere{background:radial-gradient(circle at 40% 35%, #9fd6ff 0%, #5aa6ff 44%, #2f6fd9 65%, #1b3f9a 100%)}
.light .map{filter:contrast(130%)}
.light .footer-cta.full{background:
 linear-gradient(180deg, rgba(140,205,180,.85), rgba(110,180,150,.9)),
 radial-gradient(120% 80% at 50% -10%, rgba(235,255,245,.35), transparent 60%); color:#0b231a}

/* Toast */
.toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%);background:#111a28;color:#e9eef4;border:1px solid var(--line);padding:8px 12px;border-radius:10px;z-index:70;box-shadow:0 10px 24px rgba(0,0,0,.35);display:none}
.toast.show{display:block;animation:fade 2.2s ease forwards}
@keyframes fade{0%{opacity:0;transform:translate(-50%,8px)}10%{opacity:1;transform:translate(-50%,0)}90%{opacity:1}100%{opacity:0}}

/* Utility */
.input{width:100%;padding:10px;border-radius:10px;border:1px solid var(--line);background:#0e1720;color:var(--txt}
.light .input{background:#f3f7f3}
.header-flex b.big{font-size:20px}
.section-title{margin:0 0 8px}
</style>
</head>
<body>
<div class="wrap">
  <!-- Top pills -->
  <div class="row">
    <span class="pill logo-hero"><span class="logo-dot"></span><b>UltraMaster VâˆÎ©Î›Î</b></span>
    <span class="pill">ENS: <b id="ens">lightunfold.eth</b></span>
    <span class="pill">Heartbeat: <b id="hb">LIVE</b></span>
    <button class="pill" id="openData">Data</button>
    <span class="pill" id="lang">VI/EN</span>
    <span class="pill" id="theme">ğŸŒ— Theme</span>
  </div>

  <!-- HERO -->
  <section class="card hero">
    <div class="ribbon"></div>
    <div class="header-flex">
      <div>
        <h1 id="brand">LightUnfold â€¢ UltraMaster VâˆÎ©Î›Î</h1>
        <div class="note" id="tagline">Web3 cá»§a báº¡n â€“ Trá»£ lÃ½ tÃ i chÃ­nh AI 24/7 â€¢ Token chá»n lá»c (free) + Top 3 premium â€¢ Má»Ÿ khoÃ¡ táº¡i chá»—</div>
        <div class="card" style="margin-top:10px;background:#0f1720;border-color:#244c36">
          <b style="color:#d1ffe3" id="motto">â€œBiáº¿t sá»›m â€“ Quyáº¿t Ä‘á»‹nh sá»›m â€“ Lá»£i tháº¿ sá»›m.â€</b><br>
          <span id="heroBlend">NÆ¡i há»™i tá»¥: <b>KhoÃ¡ há»c tinh gá»n</b>, <b>PhÃ¢n tÃ­ch Crypto realtime</b>, <b>AI há»i Ä‘Ã¡p</b> vÃ  <b>CÆ¡ há»™i Ä‘áº§u tÆ° sá»›m nháº¥t</b>.</span>
        </div>
        <div class="hero-cta" style="margin-top:10px" id="belowGlobe">
          <a class="btn out" id="ctaBinance" href="https://www.binance.com/vi/register?ref=GRO_20338_9V44N" target="_blank" rel="noopener">Má»Ÿ tÃ i khoáº£n Binance â†—</a>
          <a class="btn out" id="ctaAlgos" href="https://algosone.page.link/MbtR" target="_blank" rel="noopener">DÃ¹ng thá»­ AlgosOne â†—</a>
        </div>
      </div>
      <div style="position:relative;display:grid;place-items:center;gap:4px">
        <div class="globe" aria-hidden="true">
          <div class="sphere"></div>
          <div class="map"></div>
          <div class="moon"></div>
        </div>
        <div class="ticker3" id="ticker3">
          <span class="chip">BTC â€” â€”</span><span class="chip">ETH â€” â€”</span><span class="chip">USDT â€” â€”</span>
        </div>
      </div>
    </div>
  </section>

  <!-- KPI -->
  <div class="kpi">
    <div class="kbox"><div class="muted" id="k1lbl">CÆ¡ há»™i</div><div class="now" id="kOpps">0</div></div>
    <div class="kbox"><div class="muted" id="k2lbl">Cáº­p nháº­t</div><div class="now" id="kUpd">â€”</div></div>
    <div class="kbox"><div class="muted" id="k3lbl">Äang xem</div><div class="now" id="kLive">â€”</div></div>
    <div class="kbox"><div class="muted" id="k4lbl">Doanh thu</div><div class="now">$<span id="kRev">0</span></div></div>
  </div>

  <!-- 1) TOP 3 PREMIUM (masked) + Unlock -->
  <section class="card" id="top3">
    <h3 class="section-title" id="top3Title">â­ Top 3 Token tiá»m nÄƒng (má»Ÿ khoÃ¡ Ä‘á»ƒ xem chi tiáº¿t)</h3>
    <div id="tokenPro" class="grid" style="margin-top:8px"></div>
    <div class="card footer-cta" style="margin-top:10px">
      <b id="top3Pitch">Muá»‘n xem danh sÃ¡ch Ä‘áº§y Ä‘á»§ + Ä‘iá»ƒm vÃ o/ra an toÃ n?</b>
      <div class="row" style="margin-top:8px"><a class="btn" href="#supergate" id="top3Unlock">Má»Ÿ khoÃ¡ ngay</a><button class="btn out" id="refreshNow">â†» LÃ m má»›i</button></div>
    </div>
  </section>

  <!-- 2) TOKEN FREE (curated) -->
  <section class="card" id="freeTokens">
    <h3 class="section-title" id="freeTitle">ğŸ“Š Token Ä‘Æ°á»£c chá»n lá»c â€” cáº­p nháº­t realtime</h3>
    <div class="grid" id="tokenFree"></div>
  </section>

  <!-- 3) Há»c viá»‡n -->
  <section class="card" id="edu">
    <h3 class="section-title" id="eduTitle">ğŸ“š Há»c viá»‡n</h3>
    <div class="grid" id="ebooks"></div>
  </section>

  <!-- 4) CÆ¡ há»™i ná»•i báº­t -->
  <section class="card" id="hot">
    <div class="row" style="justify-content:space-between">
      <h3 class="section-title" id="hotTitle">ğŸ”¥ CÆ¡ há»™i ná»•i báº­t</h3>
      <div class="row"><span class="badge" id="scanMode">quÃ©t: data</span><button class="btn out" id="refreshNow2">â†»</button></div>
    </div>
    <div class="marquee" style="margin:4px 0 8px;color:#bcd"><div id="ticker">â€”</div></div>
    <div id="opps" class="list"></div>
  </section>

  <!-- 5) GÃ³i Premium -->
  <section class="card" id="packs">
    <h3 class="section-title" id="packTitle">ğŸ§° GÃ³i premium</h3>
    <div class="grid" id="bundles"></div>
  </section>

  <!-- 6) SUPERGATE: Pay + Unlock inline -->
  <section class="card" id="supergate">
    <h3 class="section-title" id="gateTitle">ğŸ”“ Cá»­a má»Ÿ khoÃ¡ (SuperGate)</h3>
    <div class="paygrid">
      <!-- Left: Payment compact -->
      <div class="card" style="background:#0f1720">
        <div class="qrbox">
          <img id="qr" class="qr" alt="QR" src="" loading="lazy">
          <div style="flex:1;min-width:0">
            <div class="note" id="gatePitch"><b>Thanh toÃ¡n nhá» â†’ nháº­n mÃ£ â†’ má»Ÿ Top 3 & kho kiáº¿n thá»©c ngay táº¡i Ä‘Ã¢y.</b></div>
            <div class="note"><span id="addrLbl">Äá»‹a chá»‰</span>: <span class="mono" id="payAddr">â€”</span> <span class="copy" id="copyAddr">ğŸ“‹</span></div>
            <div class="note"><span id="minLbl">Tá»‘i thiá»ƒu</span>: <span id="minHint">ETH â‰¥ 0.0005, USDT â‰¥ $5</span></div>
            <div class="paymethods" id="payList"></div>
          </div>
        </div>
      </div>
      <!-- Right: Choose bundle + unlock input -->
      <div class="card" style="background:#0f1720">
        <div class="grid" style="grid-template-columns:1fr">
          <div>
            <label class="note" id="chooseBundleLbl">Chá»n gÃ³i</label>
            <select id="bundleSel" class="input"></select>
          </div>
          <div>
            <label class="note" id="enterCodeLbl">Nháº­p mÃ£ má»Ÿ khoÃ¡</label>
            <input id="unlockCode" class="input" placeholder="Nháº­p mÃ£â€¦">
          </div>
          <div><input id="txhash" class="input" placeholder="(Tuá»³ chá»n) DÃ¡n TX hash / ghi chÃº"></div>
          <div class="row">
            <button class="btn" id="doUnlock">Má»Ÿ khoÃ¡</button>
            <button class="btn out" id="remember">Nhá»› mÃ£</button>
          </div>
          <div id="uMsg" class="note"></div>
          <div class="note" style="margin-top:6px" id="afterUnlockHint">Sau khi má»Ÿ khoÃ¡, ná»™i dung premium xuáº¥t hiá»‡n ngay bÃªn dÆ°á»›i. MÃ£ Ä‘Æ°á»£c nhá»› trÃªn thiáº¿t bá»‹.</div>
        </div>
      </div>
    </div>

    <!-- Premium area appears here after unlock -->
    <div id="opened" class="hidden" style="margin-top:12px">
      <div class="row"><span class="pill ok" id="unlockedLbl">âœ” ÄÃ£ má»Ÿ khoÃ¡</span><button class="btn out" id="relock">KhoÃ¡ láº¡i</button></div>
      <div id="premium" class="grid" style="margin-top:10px"></div>
    </div>
  </section>

  <!-- 7) AlgosOne -->
  <section class="card" id="algos">
    <h3 class="section-title">ğŸ¤ AlgosOne â€“ AI giao dá»‹ch thá»±c chiáº¿n</h3>
    <div class="grid">
      <div class="shop-card" style="border-color:#1b5cff40">
        <h4 id="aoTitle">AlgosOne â€“ tá»‘i Æ°u chiáº¿n lÆ°á»£c, cáº£nh bÃ¡o realtime</h4>
        <div class="note" id="aoCopy">â€œÄá»ƒ mÃ¡y há»c Ä‘á» xuáº¥t â€“ báº¡n giá»¯ ká»· luáº­t.â€ Backtest nhanh â€¢ Cáº£nh bÃ¡o theo rá»§i ro â€¢ Káº¿t ná»‘i nhiá»u sÃ n â€¢ API máº¡nh.</div>
        <div class="row">
          <a class="btn" id="aoBtn" href="https://algosone.page.link/MbtR" target="_blank" rel="noopener">DÃ¹ng thá»­ miá»…n phÃ­ â†—</a>
          <button class="btn out" id="aoShare">Chia sáº»</button>
        </div>
      </div>
    </div>
  </section>

  <!-- 8) Binance -->
  <section class="card" id="binance">
    <h3 class="section-title">ğŸ›ï¸ Binance â€“ bÆ°á»›c khá»Ÿi Ä‘áº§u thÃ´ng minh</h3>
    <div class="grid">
      <div class="shop-card" style="border-color:#f2c97940">
        <h4 id="bnTitle">Giao dá»‹ch nÆ¡i thanh khoáº£n sÃ¢u nháº¥t</h4>
        <div class="note" id="bnCopy">PhÃ­ cáº¡nh tranh â€¢ Earn/Futures/Options â€¢ Launchpad/Launchpool â€¢ Báº£o máº­t & API máº¡nh. Má»Ÿ tÃ i khoáº£n trong 1 phÃºt.</div>
        <div class="row">
          <a class="btn" id="bnBtn" href="https://www.binance.com/vi/register?ref=GRO_20338_9V44N" target="_blank" rel="noopener">Má»Ÿ tÃ i khoáº£n miá»…n phÃ­ â†—</a>
          <button class="btn out" id="bnShare">Chia sáº»</button>
        </div>
      </div>
    </div>
  </section>

  <!-- 9) CTA xanh toÃ n chiá»u ngang -->
  <section class="card footer-cta full">
    <h3 style="margin:0 0 6px" id="ctaFinalH">ğŸš€ CÆ¡ há»™i khÃ´ng chá» Ä‘á»£i â€“ báº¡n cÅ©ng Ä‘á»«ng chá»!</h3>
    <div id="ctaFinalP">Chá»‰ cáº§n <b>má»Ÿ khoÃ¡</b> hoáº·c <b>Ä‘Äƒng kÃ½ miá»…n phÃ­</b> hÃ´m nay, báº¡n bÆ°á»›c vÃ o <b>há»‡ thá»‘ng AI tÃ i chÃ­nh 24/7</b> â€“ nÆ¡i má»i nhá»‹p thá»‹ trÆ°á»ng Ä‘á»u trong táº§m tay.</div>
    <div class="row" style="margin-top:10px">
      <a class="btn" href="#supergate" id="ctaUnlock">Má»Ÿ khoÃ¡ ngay</a>
      <a class="btn out" id="ctaBinance2" href="https://www.binance.com/vi/register?ref=GRO_20338_9V44N" target="_blank" rel="noopener">ÄÄƒng kÃ½ Binance â†—</a>
      <a class="btn out" id="ctaAlgos2" href="https://algosone.page.link/MbtR" target="_blank" rel="noopener">DÃ¹ng thá»­ AlgosOne â†—</a>
      <button class="btn out" id="shareMine">Chia sáº» liÃªn káº¿t cá»§a tÃ´i</button>
    </div>
  </section>

  <button class="pill" id="goTop" style="position:fixed;left:12px;bottom:80px;z-index:40">â†‘ Top</button>
  <div class="footer">Â© <span id="year"></span> LightUnfold â€¢ <span id="autoLbl">Tá»± Ä‘á»™ng 24/7</span></div>
</div>

<!-- Share floating -->
<div class="sharebar" style="position:fixed;right:12px;bottom:12px;display:flex;gap:8px;background:var(--card);border:1px solid var(--line);border-radius:12px;padding:8px;z-index:40">
  <a id="sh_tg" target="_blank" title="Share Telegram">ğŸ“£</a>
  <a id="sh_x"  target="_blank" title="Share X/Twitter">ğ•</a>
  <a id="sh_fb" target="_blank" title="Share Facebook">f</a>
  <a id="sh_in" target="_blank" title="Share LinkedIn">in</a>
</div>

<!-- Chat 24/7 -->
<button class="btn chatfab" id="openChat">ğŸ§  Chat AI 24/7</button>
<div class="chatwin" id="chat" role="dialog" aria-label="AI Chat">
  <div class="chathead"><b id="chatTitle">AI TÃ i ChÃ­nh 24/7</b><div class="row"><button class="btn out" id="minChat">â€”</button><button class="btn out" id="closeChat">âœ–</button></div></div>
  <div class="chatbody" id="chatBody"></div>
  <div style="padding:0 10px" id="chipBar"></div>
  <div class="chatinput">
    <input id="chatIn" class="input" placeholder="Há»i thá»‹ trÆ°á»ng, token, káº¿ hoáº¡ch lá»‡nhâ€¦">
    <button class="btn" id="chatSend">Gá»­i</button>
  </div>
</div>

<!-- Modal hiá»ƒn thá»‹ dá»¯ liá»‡u premium -->
<div id="dataModal" class="hidden" style="position:fixed;inset:0;background:rgba(0,0,0,.6);display:grid;place-items:center;z-index:80">
  <div id="dataBox" style="width:min(92vw,900px);height:min(80vh,700px);background:var(--card);border:1px solid var(--line);border-radius:14px;overflow:hidden;display:flex;flex-direction:column">
    <header style="display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-bottom:1px solid var(--line)">
      <b id="dataTitle">Dá»¯ liá»‡u Premium</b>
      <button class="btn" id="closeData">ÄÃ³ng</button>
    </header>
    <pre id="dataPre" style="flex:1;margin:0;padding:12px;overflow:auto;background:#0b0f13;color:#dff7ea"></pre>
  </div>
</div>

<div id="toast" class="toast">ÄÃ£ sao chÃ©p</div>

<script>
/* ===== helpers ===== */
const $=s=>document.querySelector(s), $$=s=>document.querySelectorAll(s);
const fmt=n=>Number(n||0).toLocaleString(undefined,{maximumFractionDigits:8});
const qrlink=t=>`https://api.qrserver.com/v1/create-qr-code/?size=320x320&data=${encodeURIComponent(t)}`;
const showToast=(t)=>{const el=$('#toast'); el.textContent=t||el.textContent; el.classList.add('show'); setTimeout(()=>el.classList.remove('show'),2000);}
function setTheme(m){document.documentElement.classList.toggle('light',m==='light');localStorage.setItem('theme',m)}
setTheme(localStorage.getItem('theme')||'dark');
$('#theme')?.addEventListener('click',()=>setTheme(document.documentElement.classList.contains('light')?'dark':'light'));
$('#year').textContent=new Date().getFullYear();
$('#goTop').onclick=()=>window.scrollTo({top:0,behavior:'smooth'});
let LAST_ITEMS=[], LAST_TS=null;

/* ===== ViralShare 2.0 ===== */
(function ViralShare(){
  const U = new URL(location.href);
  const refIn = U.searchParams.get('ref');
  const peer = localStorage.getItem('peer_id') || Math.random().toString(36).slice(2);
  if(!localStorage.getItem('peer_id')) localStorage.setItem('peer_id', peer);
  if(refIn) localStorage.setItem('ref_by', refIn);
  const base = location.origin + location.pathname;
  const myRef = `${base}?ref=${peer}&utm_source=share&utm_medium=viral&utm_campaign=ultramaster`;
  localStorage.setItem('my_ref', myRef);
  const t = encodeURIComponent(document.title), u = encodeURIComponent(myRef);
  $('#sh_tg').href=`https://t.me/share/url?url=${u}&text=${t}`;
  $('#sh_x').href =`https://twitter.com/intent/tweet?text=${t}&url=${u}`;
  $('#sh_fb').href=`https://www.facebook.com/sharer/sharer.php?u=${u}`;
  $('#sh_in').href=`https://www.linkedin.com/sharing/share-offsite/?url=${u}`;
  $('#shareMine').onclick=async()=>{try{if(navigator.share){await navigator.share({title:document.title,text:'KhÃ¡m phÃ¡ UltraMaster',url:myRef});}else{await navigator.clipboard.writeText(myRef);showToast('ÄÃ£ sao chÃ©p liÃªn káº¿t!');}}catch(_){}}; 
  const refBy=localStorage.getItem('ref_by'); if(refBy){const badge=document.createElement('div');badge.className='pill';badge.style.marginTop='8px';badge.textContent='âœ¨ Báº¡n truy cáº­p tá»« liÃªn káº¿t giá»›i thiá»‡u. ChÃ o má»«ng!'; $('#belowGlobe')?.appendChild(badge);}
})();

/* ===== i18n ===== */
let LANG=(localStorage.getItem('lang')||navigator.language||'vi').toLowerCase().startsWith('vi')?'vi':'en';
const i18n={
  vi:{
    brand:"LightUnfold â€¢ UltraMaster VâˆÎ©Î›Î",
    tagline:"Web3 cá»§a báº¡n â€“ Trá»£ lÃ½ tÃ i chÃ­nh AI 24/7 â€¢ Token chá»n lá»c (free) + Top 3 premium â€¢ Má»Ÿ khoÃ¡ táº¡i chá»—",
    motto:"â€œBiáº¿t sá»›m â€“ Quyáº¿t Ä‘á»‹nh sá»›m â€“ Lá»£i tháº¿ sá»›m.â€",
    heroBlend:"NÆ¡i há»™i tá»¥: <b>KhoÃ¡ há»c tinh gá»n</b>, <b>PhÃ¢n tÃ­ch Crypto realtime</b>, <b>AI há»i Ä‘Ã¡p</b> vÃ  <b>CÆ¡ há»™i Ä‘áº§u tÆ° sá»›m nháº¥t</b>.",
    k1:"CÆ¡ há»™i",k2:"Cáº­p nháº­t",k3:"Äang xem",k4:"Doanh thu",
    top3Title:"â­ Top 3 Token tiá»m nÄƒng (má»Ÿ khoÃ¡ Ä‘á»ƒ xem chi tiáº¿t)", top3Pitch:"Muá»‘n xem danh sÃ¡ch Ä‘áº§y Ä‘á»§ + Ä‘iá»ƒm vÃ o/ra an toÃ n?",
    freeTitle:"ğŸ“Š Token Ä‘Æ°á»£c chá»n lá»c â€” cáº­p nháº­t realtime",
    eduTitle:"ğŸ“š Há»c viá»‡n", hotTitle:"ğŸ”¥ CÆ¡ há»™i ná»•i báº­t", packTitle:"ğŸ§° GÃ³i premium",
    gateTitle:"ğŸ”“ Cá»­a má»Ÿ khoÃ¡ (SuperGate)", gatePitch:"<b>Thanh toÃ¡n nhá» â†’ nháº­n mÃ£ â†’ má»Ÿ Top 3 & kho kiáº¿n thá»©c ngay táº¡i Ä‘Ã¢y.</b>",
    addrLbl:"Äá»‹a chá»‰", minLbl:"Tá»‘i thiá»ƒu", chooseBundleLbl:"Chá»n gÃ³i", enterCodeLbl:"Nháº­p mÃ£ má»Ÿ khoÃ¡",
    afterUnlockHint:"Sau khi má»Ÿ khoÃ¡, ná»™i dung premium xuáº¥t hiá»‡n ngay bÃªn dÆ°á»›i. MÃ£ Ä‘Æ°á»£c nhá»› trÃªn thiáº¿t bá»‹.",
    unlockedLbl:"âœ” ÄÃ£ má»Ÿ khoÃ¡",
    ctaFinalH:"ğŸš€ CÆ¡ há»™i khÃ´ng chá» Ä‘á»£i â€“ báº¡n cÅ©ng Ä‘á»«ng chá»!",
    ctaFinalP:"Chá»‰ cáº§n <b>má»Ÿ khoÃ¡</b> hoáº·c <b>Ä‘Äƒng kÃ½ miá»…n phÃ­</b> hÃ´m nay, báº¡n bÆ°á»›c vÃ o <b>há»‡ thá»‘ng AI tÃ i chÃ­nh 24/7</b> â€“ nÆ¡i má»i nhá»‹p thá»‹ trÆ°á»ng Ä‘á»u trong táº§m tay.",
    ctaUnlock:"Má»Ÿ khoÃ¡ ngay",
    ctaBinance:"Má»Ÿ tÃ i khoáº£n Binance â†—", ctaAlgos:"DÃ¹ng thá»­ AlgosOne â†—",
    bnTitle:"Giao dá»‹ch nÆ¡i thanh khoáº£n sÃ¢u nháº¥t", bnCopy:"PhÃ­ cáº¡nh tranh â€¢ Earn/Futures/Options â€¢ Launchpad/Launchpool â€¢ Báº£o máº­t & API máº¡nh. Má»Ÿ tÃ i khoáº£n trong 1 phÃºt.",
    aoTitle:"AlgosOne â€“ tá»‘i Æ°u chiáº¿n lÆ°á»£c, cáº£nh bÃ¡o realtime",
    aoCopy:"â€œÄá»ƒ mÃ¡y há»c Ä‘á» xuáº¥t â€“ báº¡n giá»¯ ká»· luáº­t.â€ Backtest nhanh â€¢ Cáº£nh bÃ¡o theo rá»§i ro â€¢ Káº¿t ná»‘i nhiá»u sÃ n â€¢ API máº¡nh.",
    btnDetails:"Chi tiáº¿t â†—", btnChart:"Má»Ÿ biá»ƒu Ä‘á»“ â†—", btnAI:"AI phÃ¢n tÃ­ch nhanh", btnBuyEnter:"Má»Ÿ khoÃ¡", btnCopy:"Sao chÃ©p",
    saved:"ÄÃ£ lÆ°u trÃªn thiáº¿t bá»‹.", invalid:"MÃ£ khÃ´ng Ä‘Ãºng.", unlocked:"âœ” ÄÃ£ má»Ÿ khoÃ¡",
    chatTitle:"AI TÃ i ChÃ­nh 24/7", chatHi:"ChÃ o báº¡n! MÃ¬nh lÃ  AI tÃ i chÃ­nh 24/7. Token chá»n lá»c miá»…n phÃ­, Top 3 cáº§n má»Ÿ khoÃ¡.",
    chatTyping:"Ä‘ang nháº­pâ€¦", chatPlaceholder:"Há»i thá»‹ trÆ°á»ng, token, káº¿ hoáº¡ch lá»‡nhâ€¦",
    toastCopied:"ÄÃ£ sao chÃ©p!", dataTitle:"Dá»¯ liá»‡u Premium", dataClose:"ÄÃ³ng",
    scanData:"quÃ©t: data", scanFallback:"quÃ©t: live", alwaysOn:"Tá»± Ä‘á»™ng 24/7"
  },
  en:{
    brand:"LightUnfold â€¢ UltraMaster VâˆÎ©Î›Î",
    tagline:"Your Web3 â€“ 24/7 Finance AI â€¢ Curated tokens (free) + Top 3 premium â€¢ On-page unlock",
    motto:"â€œKnow early â€“ Decide early â€“ Win early.â€",
    heroBlend:"Where <b>lean courses</b>, <b>realtime crypto analysis</b>, <b>AI Q&A</b> and <b>earliest opportunities</b> meet.",
    k1:"Opportunities",k2:"Updated",k3:"Live",k4:"Revenue",
    top3Title:"â­ Top 3 Potential Tokens (unlock to view details)", top3Pitch:"See full list + safe entries/exits?",
    freeTitle:"ğŸ“Š Curated tokens â€” realtime updates",
    eduTitle:"ğŸ“š Academy", hotTitle:"ğŸ”¥ Hot opportunities", packTitle:"ğŸ§° Premium bundles",
    gateTitle:"ğŸ”“ SuperGate (Unlock here)", gatePitch:"<b>Small payment â†’ code â†’ unlock Top 3 & knowledge vault right here.</b>",
    addrLbl:"Address", minLbl:"Minimum", chooseBundleLbl:"Choose bundle", enterCodeLbl:"Enter unlock code",
    afterUnlockHint:"After unlocking, premium content appears below. Code is remembered on your device.",
    unlockedLbl:"âœ” Unlocked",
    ctaFinalH:"ğŸš€ Opportunity wonâ€™t wait â€” neither should you!",
    ctaFinalP:"Just <b>unlock</b> or <b>sign up free</b> today to enter the <b>24/7 finance AI</b> â€” every market pulse in your hand.",
    ctaUnlock:"Unlock now",
    ctaBinance:"Open Binance account â†—", ctaAlgos:"Try AlgosOne â†—",
    bnTitle:"Trade where liquidity is deepest", bnCopy:"Low fees â€¢ Earn/Futures/Options â€¢ Launchpad/Launchpool â€¢ Security & strong API. Open in 1 minute.",
    aoTitle:"AlgosOne â€“ strategy optimization, realtime alerts",
    aoCopy:"â€œLet ML suggest â€” you keep discipline.â€ Fast backtest â€¢ Risk-aware alerts â€¢ Multi-exchange â€¢ Robust API.",
    btnDetails:"Details â†—", btnChart:"Open chart â†—", btnAI:"Quick AI read", btnBuyEnter:"Unlock", btnCopy:"Copy",
    saved:"Saved on device.", invalid:"Invalid code.", unlocked:"âœ” Unlocked",
    chatTitle:"24/7 Finance AI", chatHi:"Hi! Iâ€™m your 24/7 finance AI. Curated tokens are free; Top 3 requires unlock.",
    chatTyping:"typingâ€¦", chatPlaceholder:"Ask market, tokens, planâ€¦",
    toastCopied:"Copied!", dataTitle:"Premium Data", dataClose:"Close",
    scanData:"scan: data", scanFallback:"scan: live", alwaysOn:"Always-on 24/7"
  }
};
function applyLang(){
  const L=i18n[LANG];
  $('#brand').textContent=L.brand; $('#tagline').textContent=L.tagline; $('#motto').textContent=L.motto; $('#heroBlend').innerHTML=L.heroBlend;
  $('#k1lbl').textContent=L.k1; $('#k2lbl').textContent=L.k2; $('#k3lbl').textContent=L.k3; $('#k4lbl').textContent=L.k4;
  $('#top3Title').textContent=L.top3Title; $('#top3Pitch').textContent=L.top3Pitch; $('#freeTitle').textContent=L.freeTitle;
  $('#eduTitle').textContent=L.eduTitle; $('#hotTitle').textContent=L.hotTitle; $('#packTitle').textContent=L.packTitle;
  $('#gateTitle').textContent=L.gateTitle; $('#gatePitch').innerHTML=L.gatePitch; $('#addrLbl').textContent=L.addrLbl; $('#minLbl').textContent=L.minLbl;
  $('#chooseBundleLbl').textContent=L.chooseBundleLbl; $('#enterCodeLbl').textContent=L.enterCodeLbl; $('#afterUnlockHint').textContent=L.afterUnlockHint;
  $('#unlockedLbl').textContent=L.unlockedLbl; $('#ctaFinalH').textContent=L.ctaFinalH; $('#ctaFinalP').innerHTML=L.ctaFinalP; $('#ctaUnlock').textContent=L.ctaUnlock;
  $('#ctaBinance').textContent=L.ctaBinance; $('#ctaAlgos').textContent=L.ctaAlgos; $('#ctaBinance2').textContent=L.ctaBinance; $('#ctaAlgos2').textContent=L.ctaAlgos;
  $('#bnTitle').textContent=L.bnTitle; $('#bnCopy').textContent=L.bnCopy; $('#aoTitle').textContent=L.aoTitle; $('#aoCopy').textContent=L.aoCopy;
  $('#chatTitle').textContent=L.chatTitle; $('#chatIn').placeholder=L.chatPlaceholder; $('#dataTitle').textContent=L.dataTitle; $('#closeData').textContent=L.dataClose;
  $('#autoLbl').textContent=L.alwaysOn;
  // re-render dynamic sections with language-sensitive labels
  paintBundles(); paintPremium(); if(LAST_ITEMS.length) renderAll(LAST_ITEMS);
}
$('#lang')?.addEventListener('click',()=>{LANG=LANG==='vi'?'en':'vi';localStorage.setItem('lang',LANG);applyLang();});

/* ===== Config ===== */
const CFG={
  site:{brand:"LightUnfold â€¢ UltraMaster VâˆÎ©Î›Î",ens:"lightunfold.eth",
    payments:{chains:[
      {name:"ETH (EVM)",address:"0x54E15A7b6d4213beE87800432A151d794638E3C2",explorer:"https://etherscan.io/address/0x54E15A7b6d4213beE87800432A151d794638E3C2",min:"â‰¥ 0.0005 ETH"},
      {name:"USDT (ERC20)",address:"0x5da80d0f7e2df3cb0aa73d6a942bbe36b046b8f0",explorer:"https://etherscan.io/token/USDT?a=0x5da80d0f7e2df3cb0aa73d6a942bbe36b046b8f0",min:"â‰¥ $5"},
      {name:"MoMo",address:"0567892030",min:"â€”"},
      {name:"Vietcombank",address:"9567892030",min:"â€”"},
      {name:"PayPal",address:"vumumabada@gmail.com",min:"â€”"}
    ]},
  },
  secrets:{unlock_code:"23061988"},
  store:{
    bundles:[
      {id:"alpha",title:"Alpha Signals X",price:19,desc_vi:"TÃ­n hiá»‡u ngáº¯n háº¡n xÃ¡c suáº¥t cao.",desc_en:"High-probability short-term signals.",bullets:["Scalping","DeFi","Spot"]},
      {id:"etfbtc",title:"ETF & BTC Flow",price:29,desc_vi:"DÃ²ng vá»‘n ETF/BTC â€“ macro view.",desc_en:"ETF/BTC flows â€“ macro view.",bullets:["ETF","BTC","Flow"]},
      {id:"alts",title:"Altseason Radar",price:10,desc_vi:"Chu ká»³ xoay vÃ²ng vá»‘n.",desc_en:"Altseason cycle rotation.",bullets:["Cycle","Momentum"]}
    ],
    premium:[
      {title_vi:"Alpha Feed Pro",title_en:"Alpha Feed Pro",
       desc_vi:"DÃ²ng tin alpha siÃªu nhanh (Ä‘á»™ trá»… ms).",desc_en:"Ultra-fast alpha feeds (ms latency).",
       bullets_vi:["Báº¥t thÆ°á»ng dÃ²ng tiá»n","Nguá»“n Ä‘a kÃªnh","Bá»™ lá»c nhiá»…u"], bullets_en:["Flow anomalies","Multi-source","Noise filters"],
       link:"#"},
      {title_vi:"Deal Flow Private",title_en:"Deal Flow Private",
       desc_vi:"Tá»•ng há»£p deal/seed Ä‘ang má»Ÿ private.",desc_en:"Private seed/deal aggregation.",
       bullets_vi:["Äiá»u kiá»‡n","Æ¯u tiÃªn thá»i gian"], bullets_en:["Terms","Time priority"],
       link:"#"}
    ],
    edu:[
      {title:"Crypto 101",price:0,desc_vi:"VÃ­, báº£o máº­t, chu ká»³, quáº£n trá»‹ vá»‘n (Ä‘á»c nhanh 60p).",desc_en:"Wallets, security, cycles, capital (fast 60m).",tag_vi:"Miá»…n phÃ­",tag_en:"Free"},
      {title:"DeFi Mastery",price:10,desc_vi:"Yield â€¢ Lending â€¢ Perp â€¢ Case study.",desc_en:"Yield â€¢ Lending â€¢ Perp â€¢ Case studies.",tag_vi:"NÃ¢ng cao",tag_en:"Advanced"},
      {title:"Risk & Psychology",price:19,desc_vi:"Ká»· luáº­t, R:R, há»‡ thá»‘ng hoÃ¡ quyáº¿t Ä‘á»‹nh.",desc_en:"Discipline, R:R, systematic decision.",tag_vi:"ChuyÃªn sÃ¢u",tag_en:"Deep dive"}
    ]
  }
};

/* ===== Header apply once ===== */
$('#brand').textContent=CFG.site.brand; $('#ens').textContent=CFG.site.ens;

/* ===== BTC/ETH/USDT ticker ===== */
async function j(url){try{const r=await fetch(url,{cache:'no-store'});if(!r.ok) throw 0;return await r.json()}catch(_){return null}}
async function tick3(){
  try{
    const ids=['bitcoin','ethereum','tether'].join(',');
    const r=await j('https://api.coingecko.com/api/v3/simple/price?ids='+ids+'&vs_currencies=usd&include_24hr_change=true');
    if(!r) return;
    const m=[
      {k:'BTC',p:r.bitcoin?.usd, c:r.bitcoin?.usd_24h_change},
      {k:'ETH',p:r.ethereum?.usd, c:r.ethereum?.usd_24h_change},
      {k:'USDT',p:r.tether?.usd, c:r.tether?.usd_24h_change}
    ];
    $('#ticker3').innerHTML=m.map(o=>`<span class="chip">${o.k} $${fmt(o.p)} <b class="${(o.c||0)>=0?'ok':'bad'}">${(o.c||0).toFixed(2)}%</b></span>`).join('');
  }catch(_){}
}
setInterval(tick3, 8000); tick3();

/* ===== Market data: curate + pro ===== */
async function fetchLive(){
  const latest=await j('data/latest.json'); // optional local cache
  if(latest && Array.isArray(latest.items)){ LAST_ITEMS=latest.items; renderAll(LAST_ITEMS); return; }
  try{
    const cg=await j('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=volume_desc&per_page=60&page=1&price_change_percentage=1h,24h,7d');
    const items=(cg||[]).map(c=>({source:"coingecko",symbol:(c.symbol||"").toUpperCase(),name:c.name,price:+c.current_price||0,
      ch24h:+c.price_change_percentage_24h_in_currency||0,vol24h:+c.total_volume||0,
      mcap:+c.market_cap||0, link:`https://www.coingecko.com/en/coins/${c.id}`,
      score:(+c.price_change_percentage_1h_in_currency||0)*0.4+(+c.price_change_percentage_24h_in_currency||0)*0.35+(+c.price_change_percentage_7d_in_currency||0)*0.25+Math.log10((+c.total_volume||1))}));
    const bestBySymbol={}; for(const it of items){const k=it.symbol; if(!bestBySymbol[k]||it.score>bestBySymbol[k].score) bestBySymbol[k]=it;}
    LAST_ITEMS=Object.values(bestBySymbol).sort((a,b)=>b.score-a.score).slice(0,20);
    renderAll(LAST_ITEMS);
  }catch(_){}
}
function renderAll(items){
  const L=i18n[LANG];
  LAST_TS=Date.now(); $('#kUpd').textContent=new Date(LAST_TS).toLocaleTimeString();
  // ticker + hot list
  $('#kOpps').textContent=items.length; $('#ticker').innerHTML=items.slice(0,12).map(x=>`<span class="tag">${x.symbol}: $${fmt(x.price)} (${(x.ch24h||0).toFixed(2)}%)</span>`).join('')||'â€”';
  $('#opps').innerHTML=items.slice(0,10).map(x=>{
    const ch=x.ch24h||0,pct=`${ch>=0?'+':''}${ch.toFixed(2)}%`;
    return `<div class="item"><div class="score">+${(x.score||0).toFixed(2)}</div>
      <div style="flex:1;min-width:0">
        <div class="row" style="justify-content:space-between;gap:8px">
          <div><b>${x.symbol}</b> Â· <span class="muted">${x.name||''}</span></div>
          <a class="btn out" target="_blank" rel="noopener" href="${x.link||'#'}">${L.btnDetails}</a></div>
        <div class="row" style="gap:8px">
          <span class="tag">Price: $${fmt(x.price||0)}</span>
          <span class="tag ${ch>=0?'ok':'bad'}">24h: ${pct}</span>
          <span class="tag">Vol: $${fmt(x.vol24h||0)}</span>
        </div></div></div>`;
  }).join('');

  // FREE curated 7
  const free = items.slice(0,7);
  $('#tokenFree').innerHTML=free.map(x=>{
    const c=x.ch24h||0, rr=c>=0?'ok':'bad';
    return `<div class="shop-card">
      <h4>${x.symbol} â€” ${x.name||''}</h4>
      <div class="note">Price: $${fmt(x.price)} Â· <b class="${rr}">${c.toFixed(2)}%</b> Â· Vol: $${fmt(x.vol24h)}</div>
      <div class="row" style="margin-top:8px">
        <a class="btn out" target="_blank" rel="noopener" href="${x.link||'#'}">${L.btnChart}</a>
        <button class="btn out" onclick="aiHint('${x.symbol}')">${L.btnAI}</button>
      </div>
    </div>`;
  }).join('');

  // PRO masked top 3 (7-9)
  const pro = items.slice(7,10);
  $('#tokenPro').innerHTML=pro.map((x,i)=>{
    return `<div class="shop-card">
      <h4>â­ Premium #${i+1}</h4>
      <div class="note">Unlock to view: ${x.symbol} â€¢ Price/Vol/7d â€¢ Safe entry/exit plan.</div>
      <a class="btn" href="#supergate">${L.btnBuyEnter}</a>
    </div>`;
  }).join('');
}
$('#refreshNow').onclick=fetchLive; $('#refreshNow2').onclick=fetchLive;

/* ===== Payments: selectable + copy + QR swap ===== */
const pays=CFG.site.payments.chains;
let paySel=0;
function paintPay(){
  const first=pays[paySel]||pays[0];
  $('#qr').src=qrlink(first.address); $('#payAddr').textContent=first.address;
  $('#copyAddr').onclick=async()=>{await navigator.clipboard.writeText(first.address); showToast(i18n[LANG].toastCopied);};
  $('#minHint').textContent=first.min||'â€”';
  $('#payList').innerHTML=pays.map((c,i)=>`<button class="paybtn ${i===paySel?'act':''}" onclick="selPay(${i})">${c.name}</button>`).join('');
}
function selPay(i){paySel=i; paintPay();}
window.selPay=selPay;
paintPay();

/* ===== Bundles + Premium (with price & bullets) ===== */
function paintBundles(){
  const L=i18n[LANG];
  $('#bundleSel').innerHTML=CFG.store.bundles.map(b=>`<option value="${b.id}">${b.title} â€” $${b.price}</option>`).join('');
  $('#bundles').innerHTML=CFG.store.bundles.map(b=>{
    const desc=LANG==='vi'?b.desc_vi:b.desc_en;
    const tags=(b.bullets||[]).map(t=>`<span class="tag">${t}</span>`).join('');
    return `<div class="shop-card">
      <h4>${b.title} <span class="price">$${b.price}</span></h4>
      <div class="note">${desc}</div>
      <div style="margin-top:6px">${tags}</div>
      <div class="row" style="margin-top:8px"><a class="btn" href="#supergate">${L.btnBuyEnter}</a></div>
    </div>`;
  }).join('');
}
function paintPremium(){
  const L=i18n[LANG];
  const P=CFG.store.premium||[];
  $('#premium').innerHTML=P.map(p=>{
    const title=LANG==='vi'?p.title_vi:p.title_en;
    const desc=LANG==='vi'?p.desc_vi:p.desc_en;
    const bullets=(LANG==='vi'?p.bullets_vi:p.bullets_en)||[];
    return `<div class="shop-card"><h4>${title}</h4>
      <div class="note">${desc||''}</div>
      ${bullets.length?`<ul>${bullets.map(x=>`<li>${x}</li>`).join('')}</ul>`:""}
      <button class="btn out" onclick="openDataModal()">${LANG==='vi'?'Xem dá»¯ liá»‡u':'Open data'} â†—</button>
    </div>`;
  }).join('');
}
paintBundles(); paintPremium();

/* ===== Edu ===== */
(function paintEdu(){
  $('#ebooks').innerHTML=CFG.store.edu.map(e=>{
    const desc=LANG==='vi'?e.desc_vi:e.desc_en;
    const tag =LANG==='vi'?e.tag_vi: e.tag_en;
    return `<div class="shop-card">
      <h4>${e.title} ${e.price?`<span class="price">$${e.price}</span>`:""}</h4><div class="note">${desc}</div>
      <div class="row" style="margin-top:8px"><span class="badge">${tag}</span>
        <a class="btn" href="#supergate">${i18n[LANG].btnBuyEnter}</a>
      </div>
    </div>`;
  }).join('');
})();

/* ===== Paywall ===== */
const SECRET=String(CFG.secrets.unlock_code||'23061988');
function gate(open){$('#opened').classList.toggle('hidden',!open);}
(function bindPaywall(){
  const saved=localStorage.getItem('unlocked_code')||'';
  if(saved===SECRET){gate(true); paintPremium(); const th=localStorage.getItem('tx_hash'); if(th) $('#uMsg').innerHTML='<span class="ok">TX: '+th+'</span>';}
  $('#doUnlock').onclick=()=>{const code=$('#unlockCode').value.trim(),tx=$('#txhash').value.trim();
    if(code===SECRET){gate(true); paintPremium(); $('#uMsg').innerHTML='<span class="ok">'+i18n[LANG].unlocked+'</span>'; if(tx) localStorage.setItem('tx_hash',tx); localStorage.setItem('unlocked_code',code);}
    else $('#uMsg').innerHTML='<span class="bad">'+i18n[LANG].invalid+'</span>';};
  $('#remember').onclick=()=>{const c=$('#unlockCode').value.trim(); if(c){localStorage.setItem('unlocked_code',c); $('#uMsg').textContent=i18n[LANG].saved}};
  $('#relock').onclick=()=>{localStorage.removeItem('unlocked_code'); gate(false);};
})();

/* ===== AI Chat 24/7 ===== */
function addBubble(txt, who='ai'){
  const b=document.createElement('div'); b.className='bubble '+(who==='me'?'me':'ai'); b.innerHTML=txt; $('#chatBody').appendChild(b); $('#chatBody').scrollTop=1e6;
}
function smartReply(q){
  const s=q.toLowerCase(), L=i18n[LANG];
  if(/má»Ÿ khÃ³a|unlock|thanh toÃ¡n|premium|code/.test(s))
    return '1) QuÃ©t QR & thanh toÃ¡n nhá» â€¢ 2) Nháº­n mÃ£ â€¢ 3) Nháº­p táº¡i SuperGate Ä‘á»ƒ má»Ÿ Top 3 & kho kiáº¿n thá»©c.';
  if(/token|tiá»m nÄƒng|coin|top 3/.test(s)){
    const top=(LAST_ITEMS||[]).slice(0,5).map(x=>`${x.symbol} $${fmt(x.price)} (${(x.ch24h||0).toFixed(1)}%)`).join(' â€¢ ');
    return `Dá»±a trÃªn biáº¿n Ä‘á»™ng/khá»‘i lÆ°á»£ng hiá»‡n táº¡i: ${top}. Muá»‘n má»Ÿ Top 3 premium & káº¿ hoáº¡ch vÃ o/ra an toÃ n khÃ´ng?`;
  }
  if(/an toÃ n|risk|stop|káº¿ hoáº¡ch|plan|dca/.test(s))
    return 'KhuÃ´n khá»• an toÃ n: rá»§i ro 1â€“2%/lá»‡nh â€¢ DCA 2â€“3 nhá»‹p â€¢ SL cá»©ng â€¢ KhÃ´ng all-in â€¢ RRâ‰¥1:2 â€¢ Nháº­t kÃ½ giao dá»‹ch.';
  if(/khÃ³a há»c|course|há»c nhanh|academy/.test(s))
    return 'Lá»™ trÃ¬nh: Crypto101 (free) â†’ DeFi Mastery ($10) â†’ Risk & Psychology ($19). Muá»‘n má»Ÿ gÃ³i nÃ o?';
  if(/binance|bnb/.test(s))
    return 'â€œGiao dá»‹ch nÆ¡i thanh khoáº£n sÃ¢u nháº¥t.â€ Má»Ÿ tÃ i khoáº£n miá»…n phÃ­ táº¡i Binance: <a target="_blank" rel="noopener" href="https://www.binance.com/vi/register?ref=GRO_20338_9V44N">Ä‘Äƒng kÃ½ ngay â†—</a>';
  if(/algosone|algo/.test(s))
    return 'â€œÄá»ƒ mÃ¡y há»c Ä‘á» xuáº¥t â€“ báº¡n giá»¯ ká»· luáº­t.â€ DÃ¹ng thá»­ AlgosOne: <a target="_blank" rel="noopener" href="https://algosone.page.link/MbtR">má»Ÿ ngay â†—</a>';
  if(/share|chia sáº»|ref/.test(s)){
    const myRef=localStorage.getItem('my_ref')||location.href; return `LiÃªn káº¿t giá»›i thiá»‡u cá»§a báº¡n: <br><span class="mono">${myRef}</span><br>Gá»£i Ã½ post: â€œMÃ¬nh dÃ¹ng UltraMaster theo dÃµi token realtime + AI 24/7. Link cá»§a mÃ¬nh: ${myRef}â€`;
  }
  return 'MÃ¬nh sáºµn sÃ ng: há»i token, gÃ³i há»c, má»Ÿ khoÃ¡, an toÃ n giao dá»‹ch hoáº·c gÃµ â€œshareâ€ Ä‘á»ƒ láº¥y link giá»›i thiá»‡u.';
}
function aiHint(sym){ $('#openChat').click(); $('#chatIn').value=`PhÃ¢n tÃ­ch nhanh ${sym}`; $('#chatSend').click(); }
window.aiHint=aiHint;
(function chatInit(){
  const L=i18n[LANG];
  const chips=['TÃ³m táº¯t thá»‹ trÆ°á»ng','Token tiá»m nÄƒng hÃ´m nay','Káº¿ hoáº¡ch lá»‡nh an toÃ n','CÃ¡ch má»Ÿ khoÃ¡','Láº¥y link chia sáº»'];
  const bar=$('#chipBar'); bar.innerHTML=''; chips.forEach(t=>{const b=document.createElement('button'); b.className='btn out'; b.textContent=t; b.onclick=()=>{$('#chatIn').value=t; $('#chatSend').click();}; bar.appendChild(b);});
  $('#openChat').onclick=()=>{$('#chat').style.display='flex'; if(!$('#chatBody').dataset.hi){addBubble(i18n[LANG].chatHi); $('#chatBody').dataset.hi=1;}};
  $('#closeChat').onclick=()=>{$('#chat').style.display='none'};
  $('#minChat').onclick=()=>{$('#chat').style.maxHeight = ($('#chat').style.maxHeight==='54px'?'70vh':'54px');};
  $('#chatSend').onclick=()=>{const v=$('#chatIn').value.trim(); if(!v) return; addBubble(v,'me'); $('#chatIn').value=''; addBubble(smartReply(v),'ai');};
})();

/* ===== Modal data ===== */
const PREMIUM_DATA={
  updated_at:new Date().toISOString(),
  alpha_feed:[
    {type:"flow", text:"Inflow BTC vÃ o CEX tÄƒng dáº§n â€” theo dÃµi breakout vÃ¹ng khÃ¡ng cá»± gáº§n."},
    {type:"onchain", text:"VÃ­ lá»›n gom alt mid-cap há»‡ ETH, vol tÄƒng theo giá»."},
    {type:"macro", text:"ETF spot ghi nháº­n inflow tuáº§n thá»© 3 liÃªn tiáº¿p."}
  ],
  deals:[{name:"Seed/Private-DeFiX", note:"Allocation nhá», vesting 12m â€“ cÃ¢n Ä‘á»‘i rá»§i ro."}]
};
function openDataModal(){ $('#dataPre').textContent=JSON.stringify(PREMIUM_DATA,null,2); $('#dataModal').classList.remove('hidden'); }
$('#openData')?.addEventListener('click', openDataModal);
$('#closeData')?.addEventListener('click', ()=>$('#dataModal').classList.add('hidden'));
$('#dataModal').addEventListener('click',e=>{if(e.target.id==='dataModal') $('#dataModal').classList.add('hidden');});
document.addEventListener('keydown',e=>{if(e.key==='Escape') $('#dataModal').classList.add('hidden');});

/* ===== Live counters ===== */
(function peers(){
  const k='um_peers'; const now=Date.now(), ttl=25e3; const id=localStorage.getItem('peer_id')||Math.random().toString(36).slice(2); localStorage.setItem('peer_id',id);
  const raw=localStorage.getItem(k); let list=raw?JSON.parse(raw):[]; list=list.filter(x=>now-x.t<ttl); const me=list.find(x=>x.id===id); if(me) me.t=now; else list.push({id,t:now});
  localStorage.setItem(k,JSON.stringify(list)); $('#kLive').textContent=list.length; setTimeout(peers,4000);
})();

/* ===== Loops ===== */
async function boot(){ applyLang(); await fetchLive(); setInterval(fetchLive, 60*1000); setInterval(()=>{if(LAST_TS) $('#kUpd').textContent=new Date(LAST_TS).toLocaleTimeString();},10000); }
boot();

/* ===== End ===== */
</script>
</body>
</html>
