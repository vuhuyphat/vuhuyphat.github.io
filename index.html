<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>LightUnfold ‚Ä¢ One‚ÄëPaste UltraMaster</title>
<meta name="description" content="M·ªôt l·∫ßn d√°n l√† ch·∫°y: thanh to√°n + affiliate t·ªëi ∆∞u CTR, t·ª± h·ªçc h√†nh vi, t·ª± xoay offer theo v√πng.">
<meta name="theme-color" content="#0b0f13">
<style>
:root{--bg:#0b0f13;--card:#0f141a;--line:#233041;--txt:#e9eef4;--mut:#a9b8c8;--gold:#ffd700;--btn:#ffd700;--btnTxt:#0b0f13;--ring:rgba(255,215,0,.25)}
*{box-sizing:border-box}html,body{height:100%}body{margin:0;background:radial-gradient(60% 140% at 50% -10%, rgba(109,40,217,.18),transparent 60%),linear-gradient(180deg, rgba(22,163,74,.10),transparent 40%),var(--bg);color:var(--txt);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto}
.wrap{max-width:1200px;margin:0 auto;padding:18px}
.card{background:var(--card);border:1px solid var(--line);border-radius:18px;padding:16px;margin:12px 0;box-shadow:0 10px 30px rgba(0,0,0,.28)}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.grid{display:grid;gap:14px;grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}
.pill{display:inline-flex;align-items:center;gap:8px;padding:7px 12px;border:1px solid var(--line);border-radius:999px;background:#101827}
.btn{display:inline-flex;align-items:center;gap:8px;padding:11px 14px;border:0;border-radius:12px;font-weight:800;background:var(--btn);color:var(--btnTxt);cursor:pointer;box-shadow:0 0 0 0 var(--ring);transition:.2s}
.btn:hover{transform:translateY(-1px);box-shadow:0 0 0 6px var(--ring)}
.btn.out{background:transparent;color:var(--txt);border:1px solid var(--line)}
.muted{color:var(--mut)}
.mono{font-family:ui-monospace,Menlo,Consolas,monospace}
.globe3d{width:300px;height:300px;border-radius:50%;display:block;margin:auto}
.qr{width:180px;height:180px;border-radius:12px;background:#fff}
.paybtn{display:flex;justify-content:space-between;align-items:center;border:1px solid var(--line);border-radius:12px;padding:10px 12px;background:transparent;cursor:pointer}
.paybtn.active{outline:2px solid var(--gold);box-shadow:0 0 0 6px rgba(255,215,0,.18)}
.copy{font-size:13px;border:1px dashed var(--line);border-radius:8px;padding:4px 10px;background:transparent;color:var(--txt);cursor:pointer}
.float-share{position:fixed;right:16px;bottom:16px;display:flex;gap:8px;background:var(--card);border:1px solid var(--line);border-radius:14px;padding:10px;z-index:9}
small.note{color:#a7b4c9}
</style>
</head>
<body>
<div class="wrap">
  <div class="row">
    <span class="pill"><b>LightUnfold ‚Ä¢ UltraMaster</b></span>
    <span class="pill">ENS: <b id="ens">lightunfold.eth</b></span>
    <span class="pill">Heartbeat: <b id="hb">‚Äî</b></span>
    <button class="pill" id="lang">VI/EN</button>
  </div>

  <!-- HERO -->
  <section class="card">
    <div class="row" style="justify-content:space-between">
      <div style="min-width:320px;flex:1">
        <h1 style="margin:6px 0 8px">M·ªôt l·∫ßn d√°n l√† ch·∫°y</h1>
        <div class="muted" id="tagline">Thanh to√°n ƒëa k√™nh ‚Ä¢ Affiliate t·ªëi ∆∞u CTR ‚Ä¢ T·ª± h·ªçc h√†nh vi ‚Ä¢ T·ª± xoay theo v√πng</div>
        <div class="row" style="margin-top:12px">
          <a class="btn out" id="ctaB" href="#" target="_blank" rel="noopener">M·ªü Binance Mi·ªÖn Ph√≠ ‚Üó</a>
          <a class="btn out" id="ctaA" href="#" target="_blank" rel="noopener">M·ªü AlgosOne Mi·ªÖn Ph√≠ ‚Üó</a>
        </div>
      </div>
      <div>
        <canvas id="globe3d" class="globe3d"></canvas>
        <div class="muted" style="text-align:center;margin-top:6px" id="globeCap">On‚ÄëChain Earth ¬∑ 3D</div>
      </div>
    </div>
  </section>

  <!-- PAY & AFFILIATE -->
  <section class="grid">
    <div class="card">
      <h3>Thanh to√°n nhanh</h3>
      <div id="payList" class="grid" style="grid-template-columns:1fr"></div>
      <div class="row" style="margin-top:10px">
        <div><b>ID/ƒê·ªãa ch·ªâ:</b> <span id="payAddr" class="mono">‚Äî</span></div>
        <button class="btn out" id="btnCopy">Copy</button>
      </div>
      <div class="row" style="margin-top:10px">
        <div class="qr-wrap" style="border:1px dashed var(--line);border-radius:14px;padding:10px"><img id="qr" class="qr" alt="QR"></div>
        <small class="note">Qu√©t VietQR / v√≠ crypto / PayPal.me. N·ªôi dung chuy·ªÉn: <b>LightUnfold</b>.</small>
      </div>
    </div>
    <div class="card">
      <h3>∆Øu ƒë√£i n·ªïi b·∫≠t (t·ª± h·ªçc & xoay)</h3>
      <div class="row" id="offerBox"></div>
      <div class="row" style="gap:8px;margin-top:10px">
        <span class="pill" id="tagRegion">Region: ‚Ä¶</span>
        <button class="btn out" data-region="VN">VN</button>
        <button class="btn out" data-region="GLOBAL">Global</button>
        <button class="btn out" data-region="CRYPTO">Crypto</button>
      </div>
      <small class="note">Thu·∫≠t to√°n Œµ‚Äëgreedy + UCB t·ªëi ∆∞u CTR c·ª•c b·ªô (l∆∞u tr√™n thi·∫øt b·ªã).</small>
    </div>
  </section>

  <!-- PREMIUM GATE (tu·ª≥ ch·ªçn) -->
  <section class="card">
    <h3>SuperGate (m·ªü kho√° n·ªôi dung)</h3>
    <div class="row">
      <label>M√£ m·ªü kho√°: <input id="unlockCode" placeholder="Nh·∫≠p m√£‚Ä¶"></label>
      <button class="btn" id="doUnlock">M·ªü kho√°</button>
      <button class="btn out" id="remember">Nh·ªõ m√£</button>
      <span id="uMsg" class="muted"></span>
    </div>
    <div id="opened" class="muted" style="display:none;margin-top:8px">‚úî ƒê√£ m·ªü kho√° ‚Äì n·ªôi dung Premium hi·ªÉn th·ªã.</div>
  </section>

  <div class="card">
    L·ªëi v√†o: <a href="https://vuhuyphat.github.io/" target="_blank" rel="noopener">Web2</a> ‚Ä¢
    <a href="https://lightunfold.eth.limo/" target="_blank" rel="noopener">ENS</a> ‚Äî Trang t·ª± c·∫≠p nh·∫≠t khi JSON thay ƒë·ªïi (kh√¥ng c·∫ßn ƒë·ªïi CID HTML).
  </div>
</div>

<!-- Floating share -->
<div class="float-share">
  <a id="sh_tg" target="_blank" title="Share Telegram">üì£</a>
  <a id="sh_x"  target="_blank" title="Share X">ùïè</a>
  <a id="sh_fb" target="_blank" title="Share Facebook">f</a>
  <a id="sh_in" target="_blank" title="Share LinkedIn">in</a>
</div>

<!-- Three.js (nh·∫π) -->
<script src="https://cdn.jsdelivr.net/npm/three@0.157.0/build/three.min.js"></script>
<script>
/* ================= ONE-PASTE ENGINE =================
   ‚úÖ Ch·ªâ s·ª≠a 2 ch·ªó: REMOTE_CONFIG_URL & defaults d∆∞·ªõi.
   ‚Äì Trang s·∫Ω n·∫°p JSON ƒë·ªông (GitHub Raw / IPNS) -> t·ª± ƒë·ªïi v√≠, QR, links.
   ‚Äì N·∫øu JSON l·ªói/m·∫°ng k√©m: d√πng defaults + cache localStorage.
===================================================== */

// 1) ‚Äî‚Äî CH·ªàNH CH·ªñ N√ÄY ‚Äî‚Äî (ch·ªçn 1 trong 2)
const REMOTE_CONFIG_URL =
  // 'https://raw.githubusercontent.com/<user>/<repo>/main/payments.json';
  'https://raw.githubusercontent.com/vuhuyphat/vuhuyphat.github.io/main/payments.json';
// Ho·∫∑c IPNS: 'https://ipfs.io/ipns/<your-ipns-id>'

// 2) Defaults hi·ªÉn th·ªã ngay l·∫ßn ƒë·∫ßu (ƒë·ªïi theo b·∫°n)
const defaults = {
  ens: 'lightunfold.eth',
  links: {
    binance: 'https://www.binance.com/referral/earn-together/refer-in-hotsummer/claim?hl=vi&ref=GRO_20338_9V44N',
    algos: 'https://algosone.page.link/MbtR'
  },
  payments: {
    eth:   { label:'ETH (ENS)',     id:'lightunfold.eth', scheme:'ethereum:' },
    usdt:  { label:'USDT (ERC‚Äë20)', id:'0x5da80d0f7e2df3cb0aa73d6a942bbe36b046b8f0' },
    momo:  { label:'MoMo',          id:'0567892030' },
    bank:  { label:'Vietcombank',   id:'9567892030|TR·∫¶N VƒÇN V≈®' },
    paypal:{ label:'PayPal',        id:'vumumabada@gmail.com' }
  },
  premium: { unlock_code: '23061988' }
};

// ====== Helpers
const $ = s => document.querySelector(s), $$ = s => document.querySelectorAll(s);
const LS = 'onepaste_cfg_v1';

function isVN() {
  const lang=(navigator.language||'').toLowerCase();
  const tz=Intl.DateTimeFormat().resolvedOptions().timeZone||'';
  return lang.startsWith('vi') || tz.includes('Bangkok') || tz.includes('Ho_Chi_Minh');
}
function setQR(text){ $('#qr').src = `https://api.qrserver.com/v1/create-qr-code/?size=340x340&data=${encodeURIComponent(text)}`; }
function copy(txt){ return navigator.clipboard.writeText(txt).then(()=>alert('ƒê√£ sao ch√©p.')).catch(()=>alert('Thi·∫øt b·ªã ch·∫∑n clipboard, vui l√≤ng gi·ªØ & ch·ªçn.')); }

// ====== Remote config loader (with cache + fallback)
async function loadConfig(){
  let cfg = defaults;
  try{
    const res = await fetch(REMOTE_CONFIG_URL + '?t=' + Date.now(), {cache:'no-store'});
    if(res.ok){
      const remote = await res.json();
      cfg = {...defaults, ...remote, payments:{...defaults.payments, ...(remote.payments||{})}};
      localStorage.setItem(LS, JSON.stringify(cfg));
    }else{
      const c = localStorage.getItem(LS); if(c) cfg = JSON.parse(c);
    }
  }catch(_){
    const c = localStorage.getItem(LS); if(c) cfg = JSON.parse(c);
  }
  return cfg;
}

// ====== Offers bandit (Œµ-greedy + UCB)
const STATS = 'onepaste_stats_v1';
function stats(){ try{return JSON.parse(localStorage.getItem(STATS)||'{}')}catch{return{}} }
function saveStats(s){ localStorage.setItem(STATS, JSON.stringify(s)); }
function region(){ return localStorage.getItem('ab_region') || (isVN()?'VN':'GLOBAL'); }
function pickOffer(pool){
  const s = stats(); s.stats = s.stats||{}; s.total = s.total||0;
  const eps = 0.12;
  if(Math.random()<eps) return pool[Math.floor(Math.random()*pool.length)];

  let best=pool[0], score=-1;
  for(const o of pool){
    const st=s.stats[o.id]||{};
    const ctr=(st.c||0)/Math.max(1,(st.v||0));
    const ucb=ctr + Math.sqrt(2*Math.log(1+(s.total||1))/Math.max(1,(st.v||0)));
    if(ucb>score){score=ucb; best=o;}
  }
  return best;
}
function markView(id){ const s=stats(); s.stats=s.stats||{}; s.stats[id]=s.stats[id]||{v:0,c:0}; s.stats[id].v++; s.total=(s.total||0)+1; saveStats(s); }
function markClick(id){ const s=stats(); s.stats=s.stats||{}; s.stats[id]=s.stats[id]||{v:0,c:0}; s.stats[id].c++; saveStats(s); }

// ====== Paint UI
function paintPayments(cfg){
  const pays = cfg.payments||{};
  const list = $('#payList'); list.innerHTML='';
  const rows = [];

  // Chu·∫©n h√≥a hi·ªÉn th·ªã + QR text
  const payMap = {
    eth:   v => ({title:'ETH (ENS/Address)', id: v.id, qr: (v.scheme||'ethereum:') + (v.id||'') }),
    usdt:  v => ({title:'USDT (ERC‚Äë20)',     id: v.id, qr: v.id }),
    momo:  v => ({title:'MoMo',             id: v.id, qr: v.id }),
    bank:  v => { const [acc,name]=(v.id||'').split('|'); return {title:'Vietcombank', id:`${acc} ‚Ä¢ ${name||''}`, qr:`VCB:${acc}?memo=LightUnfold&name=${encodeURIComponent(name||'')}`} },
    paypal:v => ({title:'PayPal',           id: v.id, qr: `paypal.me/${encodeURIComponent((v.id||'').split('@')[0])}` })
  };

  Object.entries(payMap).forEach(([k,fn])=>{
    if(!pays[k]) return;
    const norm = fn(pays[k]);
    const row = document.createElement('div');
    row.className='paybtn'; row.innerHTML = `<div><b>${norm.title}</b><div class="muted mono">${norm.id}</div></div><button class="copy">Copy</button>`;
    row.onclick = ()=>{ $('#payAddr').textContent = norm.id; setQR(norm.qr); $$('.paybtn').forEach(x=>x.classList.remove('active')); row.classList.add('active'); };
    row.querySelector('.copy').onclick = (e)=>{ e.stopPropagation(); copy(norm.id); };
    list.appendChild(row); rows.push(row);
  });

  if(rows[0]) rows[0].click();
  $('#btnCopy').onclick = ()=> copy($('#payAddr').textContent||'');
}

function paintOffers(cfg){
  const regionNow = region();
  $('#tagRegion').textContent = 'Region: ' + regionNow;
  const OFFERS = [
    {id:'binance', title:'M·ªü Binance Mi·ªÖn Ph√≠', url: cfg.links?.binance, regions:['VN','GLOBAL']},
    {id:'algos',   title:'M·ªü AlgosOne Mi·ªÖn Ph√≠', url: cfg.links?.algos, regions:['GLOBAL','CRYPTO','VN']}
  ].filter(o=>o.url);

  const pool = OFFERS.filter(o=>o.regions.includes(regionNow));
  const pick = pickOffer(pool.length?pool:OFFERS);
  const box = $('#offerBox');
  box.innerHTML = `
    <a class="btn out" id="offer" href="${pick.url}" target="_blank" rel="noopener">üî• ${pick.title}</a>
    ${cfg.links?.binance?`<a class="btn out" href="${cfg.links.binance}" target="_blank" rel="noopener">üöÄ Binance</a>`:''}
    ${cfg.links?.algos?`<a class="btn out" href="${cfg.links.algos}" target="_blank" rel="noopener">üåê AlgosOne</a>`:''}
  `;
  $('#offer').addEventListener('click', ()=>markClick(pick.id));
  markView(pick.id);

  // set CTA buttons
  if(cfg.links?.binance) { ['#ctaB'].forEach(id=>{ const el=$(id); if(el) el.href=cfg.links.binance; }); }
  if(cfg.links?.algos)   { ['#ctaA'].forEach(id=>{ const el=$(id); if(el) el.href=cfg.links.algos; }); }
}

function bindRegionButtons(){ 
  $$('button[data-region]').forEach(b=> b.onclick=()=>{ localStorage.setItem('ab_region', b.dataset.region); location.reload(); });
}

// ====== Premium Gate (m√£ m·ªü kho√° l∆∞u local)
function bindGate(cfg){
  const SECRET = String(cfg.premium?.unlock_code||'');
  $('#doUnlock').onclick=()=>{
    const ok = (String($('#unlockCode').value||'').trim() === SECRET);
    $('#uMsg').textContent = ok ? '‚úÖ ƒê√£ m·ªü kho√°' : '‚ùå Sai m√£';
    $('#opened').style.display = ok ? 'block' : 'none';
    if(ok) localStorage.setItem('premium_unlocked','1');
  };
  $('#remember').onclick=()=> localStorage.setItem('remember_code',$('#unlockCode').value||'');
  if(localStorage.getItem('premium_unlocked')==='1') $('#opened').style.display='block';
}

// ====== 3D Earth (t·ª± t·∫Øt n·∫øu thi·∫øt b·ªã y·∫øu)
(function earth(){
  try{
    const canvas=document.getElementById('globe3d');
    const renderer=new THREE.WebGLRenderer({canvas,antialias:true,alpha:true});
    const DPR=Math.min(window.devicePixelRatio||1,2);
    const W=canvas.clientWidth||300,H=canvas.clientHeight||300;
    renderer.setPixelRatio(DPR); renderer.setSize(W,H,false);
    const scene=new THREE.Scene();
    const camera=new THREE.PerspectiveCamera(50,W/H,0.1,100); camera.position.z=6;
    scene.add(new THREE.AmbientLight(0x9fc9ff,0.55), new THREE.DirectionalLight(0xffffff,0.95));
    const loader=new THREE.TextureLoader();
    const earth=new THREE.Mesh(new THREE.SphereGeometry(2.4,64,64),
      new THREE.MeshPhongMaterial({map:loader.load('https://threejs.org/examples/textures/planets/earth_atmos_2048.jpg')}));
    scene.add(earth);
    (function anim(){ requestAnimationFrame(anim); earth.rotation.y+=0.0024; renderer.render(scene,camera); })();
  }catch(e){ document.getElementById('globeCap').textContent='‚Äî'; }
})();

// ====== Share links
(function share(){
  const base=location.origin+location.pathname;
  const peer=localStorage.getItem('peer_id')||Math.random().toString(36).slice(2);
  localStorage.setItem('peer_id',peer);
  const myRef=`${base}?ref=${peer}`;
  const t=encodeURIComponent(document.title), u=encodeURIComponent(myRef);
  const map={sh_tg:`https://t.me/share/url?url=${u}&text=${t}`,sh_x:`https://twitter.com/intent/tweet?text=${t}&url=${u}`,sh_fb:`https://www.facebook.com/sharer/sharer.php?u=${u}`,sh_in:`https://www.linkedin.com/sharing/share-offsite/?url=${u}`};
  for(const id in map){ const el=document.getElementById(id); if(el) el.href=map[id]; }
})();

// ====== Lang & heartbeat
let LANG = (localStorage.getItem('lang')||(navigator.language||'vi')).toLowerCase().startsWith('vi')?'vi':'en';
function applyLang(){
  if(LANG==='vi'){ $('#tagline').textContent='Thanh to√°n ƒëa k√™nh ‚Ä¢ Affiliate t·ªëi ∆∞u CTR ‚Ä¢ T·ª± h·ªçc h√†nh vi ‚Ä¢ T·ª± xoay theo v√πng'; $('#globeCap').textContent='Tr√°i ƒê·∫•t On‚ÄëChain ¬∑ 3D'; }
  else           { $('#tagline').textContent='Multi‚Äëchannel payments ‚Ä¢ CTR‚Äëoptimized affiliate ‚Ä¢ On‚Äëdevice learn & region adapt'; $('#globeCap').textContent='On‚ÄëChain Earth ¬∑ 3D'; }
}
applyLang();
document.getElementById('lang').onclick=()=>{ LANG = (LANG==='vi'?'en':'vi'); localStorage.setItem('lang',LANG); applyLang(); };
setInterval(()=>{ document.getElementById('hb').textContent=new Date().toLocaleTimeString(); },1000);
document.getElementById('ens').textContent = defaults.ens;

// ====== Boot
(async function start(){
  try{
    const cfg = await loadConfig();
    paintPayments(cfg);
    paintOffers(cfg);
    bindRegionButtons();
    bindGate(cfg);
  }catch(e){ console.warn('Boot failed', e); }
})();
</script>

<!-- Service Worker (cache nh·∫π) -->
<script>
if('serviceWorker' in navigator){
  const sw = `
    self.addEventListener('install',e=>{e.waitUntil(caches.open('onepaste-v1').then(c=>c.addAll(['./'])))}); 
    self.addEventListener('fetch',e=>{e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request).then(res=>{const copy=res.clone(); caches.open('onepaste-v1').then(c=>c.put(e.request,copy)); return res;})).catch(()=>r))});
  `;
  const blob = new Blob([sw],{type:'text/javascript'}); const url = URL.createObjectURL(blob);
  navigator.serviceWorker.register(url).catch(()=>{});
}
</script>
</body>
</html>
