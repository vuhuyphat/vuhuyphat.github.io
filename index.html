<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>UltraMaster V20‚àû ‚Ä¢ Web3 Singularity</title>
<meta name="description" content="V20‚àû: AI Si√™u D·ª± ƒêo√°n ‚Ä¢ Top 3 token premium ‚Ä¢ Token ch·ªçn l·ªçc mi·ªÖn ph√≠ ‚Ä¢ SuperGate m·ªü kh√≥a t·∫°i ch·ªó ‚Ä¢ 1 QR thanh to√°n ‚Ä¢ ViralShare.">
<meta property="og:title" content="UltraMaster V20‚àû ‚Ä¢ Web3 Singularity">
<meta property="og:description" content="AI 24/7 ‚Ä¢ 70% cho ƒëi ‚Ä¢ Premium 9/19/29 ‚Ä¢ Binance & AlgosOne ‚Ä¢ ViralShare 2.0">
<meta property="og:type" content="website">
<meta name="theme-color" content="#0b0f13">
<style>
:root{
  --bg:#0b0f13;--card:#0f141a;--line:#1e2a3a;--txt:#e9eef4;--mut:#a9b8c8;
  --brand:#7dc1ff;--accent:#ffb000;--ok:#22c55e;--bad:#ff4d4f;--pill:#101825;
  --leaf:#123524;--leaf2:#0d2a1d;--gold:#ffd38a;--shadow:rgba(0,0,0,.35);
  --aura:#134e4a; /* xanh phong th·ªßy gi√†u */
  --cta:#1b4332; --cta2:#0e241c; /* CTA xanh ph·ªß */
}
*{box-sizing:border-box}html,body{margin:0;background:var(--bg);color:var(--txt);font:15px/1.6 system-ui,-apple-system,Segoe UI,Roboto}
a{color:var(--brand);text-decoration:none}
.wrap{max-width:1120px;margin:0 auto;padding:18px}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.pill{display:inline-flex;gap:8px;align-items:center;padding:6px 12px;border:1px solid var(--line);border-radius:999px;background:#101825;color:#cfe0ef}
.card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px;margin-top:12px}
.grid{display:grid;gap:14px;grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
.btn{display:inline-flex;gap:8px;align-items:center;background:var(--accent);color:#1a1300;border:0;border-radius:12px;padding:10px 14px;font-weight:800;cursor:pointer}
.btn.out{background:transparent;border:1px solid var(--line);color:var(--txt)}
.badge{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--line);border-radius:999px;padding:4px 10px}
.hidden{display:none}.mono{font-family:ui-monospace,SFMono-Regular,Consolas,monospace;word-break:break-all}
.footer{padding:28px 0;text-align:center;color:var(--mut)}
/* LIGHT (ƒë√£ thi·∫øt k·∫ø l·∫°i phong th·ªßy) */
.light{
  --bg:#f6faf8;--card:#ffffff;--line:#e3efe8;--txt:#0b0f13;--mut:#4a5568;--brand:#2563eb;--pill:#eef7f3;
  --aura:#dff6ea;--cta:#d8f3dc;--cta2:#b7e4c7;--accent:#f2b705;
}
.marquee{white-space:nowrap;overflow:hidden}.marquee>div{display:inline-block;animation:mar 25s linear infinite}
@keyframes mar{from{transform:translateX(0)}to{transform:translateX(-50%)}}
.list .item{display:flex;gap:10px;align-items:flex-start;padding:10px 0;border-top:1px dashed var(--line)}
.score{min-width:64px;text-align:center;border:1px solid var(--line);border-radius:10px;padding:4px 6px;color:#ffdca8;background:#241a00}
.tag{display:inline-block;border:1px solid var(--line);border-radius:8px;padding:2px 8px;margin:2px 4px 0 0;color:#c9d6e2;font-size:12px}
.light .tag{color:#28434b}

/* HERO v·ªõi tr√°i ƒë·∫•t xanh + trƒÉng v√†ng */
.hero{position:relative;border:1px solid var(--line);border-radius:18px;overflow:hidden;background:
 radial-gradient(70% 140% at 50% -10%, rgba(41,93,64,.45), transparent),
 radial-gradient(80% 120% at 50% 10%, rgba(21,58,40,.35), transparent),
 linear-gradient(180deg, rgba(22,54,37,.18), transparent)}
.ribbon{position:absolute;inset:auto -30% -10% -30%;height:140px;background:
 linear-gradient(90deg,rgba(52,115,84,.25),rgba(13,63,45,.05),rgba(52,115,84,.25));filter:blur(18px);transform:rotate(-2deg)}
.logo-hero{display:flex;align-items:center;gap:8px}
.logo-dot{width:12px;height:12px;border-radius:50%;background:var(--accent);box-shadow:0 0 0 0 rgba(255,176,0,.6);animation:pulse 1.6s infinite}
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(255,176,0,.5)}70%{box-shadow:0 0 0 12px rgba(255,176,0,0)}100%{box-shadow:0 0 0 0 rgba(255,176,0,0)}}
.hero-cta{display:grid;gap:10px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
.header-flex{display:grid;grid-template-columns:1.2fr .8fr;gap:14px;align-items:center}
@media (max-width:900px){.header-flex{grid-template-columns:1fr}}
/* Tr√°i ƒë·∫•t: bi·ªÉn xanh, l·ª•c ƒë·ªãa v√†ng, trƒÉng v√†ng d·ªãu */
.globe{width:min(280px,60vw);aspect-ratio:1;border-radius:50%;margin:auto;position:relative;box-shadow:0 18px 34px var(--shadow);overflow:hidden;background:#071018}
.ocean{position:absolute;inset:0;background:
 radial-gradient(circle at 50% 45%, #2bb6ff 0%, #0e7bd1 45%, #09417a 65%, #06132b 100%);}
.land{position:absolute;inset:-10%;background:
 url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400"><g fill="%23ffd38a" opacity="0.7"><path d="M84 145l28-9 22 8 18 20-9 13-20 7-26-7-13-14z"/><circle cx="540" cy="140" r="62"/><path d="M640 240l40 15-5 22-30 10-35-8 10-22z"/></g></svg>');
 background-size:200% 100%;animation:spin 18s linear infinite;mix-blend-mode:screen;filter:contrast(120%)}
@keyframes spin{from{transform:translateX(0)}to{transform:translateX(-50%)}}
.moon{position:absolute;right:6%;top:8%;width:54px;height:54px;border-radius:50%;
background: radial-gradient(circle at 35% 35%, #ffe8a3 0%, #ffd56e 45%, #e9b949 70%, rgba(0,0,0,0) 72%);
box-shadow:0 0 22px 6px rgba(255,213,110,.35), 0 0 60px rgba(255,228,160,.25);opacity:.95}
.ticker3{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;margin-top:8px}
.ticker3 .chip{border:1px dashed var(--line);border-radius:999px;padding:4px 10px;background:rgba(0,0,0,.15)}
.light .ticker3 .chip{background:#f4faf7}

/* SuperGate: Pay & Unlock */
.paygrid{display:grid;gap:12px;grid-template-columns:1fr 1fr}
@media(max-width:960px){.paygrid{grid-template-columns:1fr}}
.qrwrap{display:flex;gap:14px}
.qr{width:140px;height:140px;border-radius:12px;border:1px solid var(--line);background:#000}
.input{width:100%;padding:10px;border-radius:10px;border:1px solid var(--line);background:#0e1720;color:var(--txt}
.light .input{background:#f6fbf8}
.note{color:#9fb3c8}.light .note{color:#476166}
.shop-card{padding:14px;border:1px solid var(--line);border-radius:12px;background:#0e1720}
.light .shop-card{background:#f7fcf9}

/* CTA xanh ph·ªß cu·ªëi trang */
.footer-cta{
  border:1px dashed var(--line);border-radius:14px;padding:12px;
  background:linear-gradient(180deg, var(--cta) 0%, var(--cta2) 100%);
  box-shadow:inset 0 0 0 1px rgba(255,255,255,.05);
}

/* Chat */
.chatfab{position:fixed;right:16px;bottom:16px;z-index:30}
.chatwin{position:fixed;right:16px;bottom:80px;width:min(380px,92vw);max-height:70vh;display:none;flex-direction:column;background:var(--card);border:1px solid var(--line);border-radius:14px;overflow:hidden;z-index:31}
.chathead{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border-bottom:1px solid var(--line)}
.chatbody{padding:10px;overflow:auto;background:linear-gradient(180deg,#0b0f13 0%,#0f141a 100%)}
.chatinput{display:flex;gap:6px;padding:10px;border-top:1px solid var(--line)}
.chatinput input{flex:1} .bubble{padding:8px 10px;border:1px solid var(--line);border-radius:10px;margin:6px 0;background:#0f1826}
.bubble.me{background:#192233}

/* Modal fix (ƒë√≥ng ch·∫Øc ch·∫Øn) */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:40}
.modal.on{display:flex}
.modal .box{width:min(92vw,900px);height:min(80vh,700px);background:var(--card);border:1px solid var(--line);border-radius:14px;overflow:hidden;display:flex;flex-direction:column}
.modal header{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-bottom:1px solid var(--line)}
</style>
</head>
<body>
<div class="wrap">
  <!-- Top bar -->
  <div class="row">
    <span class="pill logo-hero"><span class="logo-dot"></span><b>UltraMaster V20‚àû</b></span>
    <span class="pill">ENS: <b id="ens">lightunfold.eth</b></span>
    <span class="pill">Heartbeat: <b id="hb">LIVE</b></span>
    <button class="pill" id="openData">data</button>
    <button class="pill" id="lang">VI/EN</button>
    <button class="pill" id="theme">üåó Theme</button>
  </div>

  <!-- HERO -->
  <section class="card hero">
    <div class="ribbon"></div>
    <div class="header-flex">
      <div>
        <h1 id="brand">LightUnfold ‚Ä¢ UltraMaster V20‚àû</h1>
        <div class="note" id="tagline"></div>
        <div class="card" style="margin-top:10px;background:var(--aura);border-color:#244c36;color:#eafff3">
          <b id="quote"></b><br><span id="hero_blurb"></span>
        </div>
        <div class="hero-cta" style="margin-top:10px" id="belowGlobe">
          <a class="btn out" id="cta_binance" target="_blank" rel="noopener"></a>
          <a class="btn out" id="cta_algos" target="_blank" rel="noopener"></a>
        </div>
      </div>
      <div style="position:relative;display:grid;place-items:center;gap:4px">
        <div class="globe">
          <div class="ocean"></div>
          <div class="land"></div>
          <div class="moon"></div>
        </div>
        <div class="ticker3" id="ticker3">
          <span class="chip">BTC ‚Äî ‚Äî</span><span class="chip">ETH ‚Äî ‚Äî</span><span class="chip">USDT ‚Äî ‚Äî</span>
        </div>
      </div>
    </div>
  </section>

  <!-- KPI -->
  <div class="kpi">
    <div class="kbox"><div class="muted" data-i18n="kpi_opps"></div><div class="now" id="kOpps">0</div></div>
    <div class="kbox"><div class="muted" data-i18n="kpi_upd"></div><div class="now" id="kUpd">‚Äî</div></div>
    <div class="kbox"><div class="muted" data-i18n="kpi_live"></div><div class="now" id="kLive">‚Äî</div></div>
    <div class="kbox"><div class="muted" data-i18n="kpi_rev"></div><div class="now">$<span id="kRev">0</span></div></div>
  </div>

  <!-- 1) TOP 3 Token Ti·ªÅm nƒÉng NH·∫§T (Premium) -->
  <section class="card">
    <h3 style="margin:0 0 8px" data-i18n="h_top3"></h3>
    <div id="tokenPro" class="grid"></div>
    <div class="row" style="margin-top:8px"><a class="btn" href="#supergate" data-i18n="cta_unlock"></a></div>
  </section>

  <!-- 2) Token ch·ªçn l·ªçc (Mi·ªÖn ph√≠, c·∫≠p nh·∫≠t li√™n t·ª•c) -->
  <section class="card">
    <h3 style="margin:0 0 8px" data-i18n="h_free_tokens"></h3>
    <div id="tokenFree" class="grid"></div>
  </section>

  <!-- 3) H·ªçc vi·ªán ‚Äî s√°ch s·ªë & kh√≥a h·ªçc -->
  <section class="card" id="edu">
    <h3 style="margin:0 0 8px" data-i18n="h_academy"></h3>
    <div id="ebooks" class="grid"></div>
  </section>

  <!-- 4) C∆° h·ªôi n·ªïi b·∫≠t (hot feed) -->
  <section class="card">
    <div class="row" style="justify-content:space-between">
      <h3 style="margin:0" data-i18n="h_hot"></h3>
      <div class="row"><span class="badge" id="scanMode"></span><button class="btn out" id="refreshNow">‚Üª</button></div>
    </div>
    <div class="marquee" style="margin:4px 0 8px;color:#bcd"><div id="ticker">‚Äî</div></div>
    <div id="opps" class="list"></div>
  </section>

  <!-- 5) G√≥i Premium (9/19/29) -->
  <section class="card" id="packs">
    <h3 style="margin:0 0 8px" data-i18n="h_packs"></h3>
    <div id="bundles" class="grid"></div>
  </section>

  <!-- 6) SUPERGATE: Thanh to√°n + M√£ m·ªü kh√≥a -->
  <section class="card" id="supergate">
    <h3 style="margin:0 0 8px" data-i18n="h_gate"></h3>
    <div class="paygrid">
      <!-- Left: Pay -->
      <div class="card" style="background:var(--aura)">
        <div class="qrwrap">
          <img id="qr" alt="QR" class="qr" src="" loading="lazy">
          <div style="flex:1;min-width:0">
            <div class="note" id="gatePitch"></div>
            <div class="note"><span data-i18n="addr_id"></span>: <span class="mono" id="payAddr">‚Äî</span></div>
            <div class="note"><span data-i18n="min_lbl"></span>: <span id="minHint"></span></div>
            <div class="row" id="payTabs" style="margin-top:8px"></div>
            <div class="row" style="margin-top:8px">
              <button class="btn" id="copyAddr" data-i18n="copy_addr"></button>
              <span id="copyMsg" class="note"></span>
            </div>
          </div>
        </div>
      </div>
      <!-- Right: Unlock -->
      <div class="card" style="background:var(--aura)">
        <div class="grid" style="grid-template-columns:1fr">
          <div>
            <label class="note" data-i18n="choose_pack"></label>
            <select id="bundleSel" class="input"></select>
          </div>
          <div>
            <label class="note" data-i18n="enter_code"></label>
            <input id="unlockCode" class="input" placeholder="">
          </div>
          <div><input id="txhash" class="input" placeholder=""></div>
          <div class="row">
            <button class="btn" id="doUnlock" data-i18n="unlock_btn"></button>
            <button class="btn out" id="remember" data-i18n="remember_btn"></button>
          </div>
          <div id="uMsg" class="note"></div>
          <div class="note" data-i18n="unlock_hint" style="margin-top:6px"></div>
        </div>
      </div>
    </div>
    <!-- Premium content render -->
    <div id="opened" class="hidden" style="margin-top:12px">
      <div class="row"><span class="pill ok" id="unlockedLbl"></span><button class="btn out" id="relock"></button></div>
      <div id="premium" class="grid" style="margin-top:10px"></div>
    </div>
  </section>

  <!-- 7) ƒê·ªëi t√°c (AlgosOne & Binance) -->
  <section class="card">
    <h3 style="margin:0 0 8px" data-i18n="h_partners"></h3>
    <div class="grid">
      <div class="shop-card">
        <h4>AlgosOne ‚Äî <span data-i18n="algos_title"></span></h4>
        <div class="note" data-i18n="algos_desc"></div>
        <a class="btn out" id="algosBtn" target="_blank" rel="noopener"></a>
      </div>
      <div class="shop-card">
        <h4>Binance ‚Äî <span data-i18n="binance_title"></span></h4>
        <div class="note" data-i18n="binance_desc"></div>
        <a class="btn out" id="binanceBtn" target="_blank" rel="noopener"></a>
      </div>
    </div>
  </section>

  <!-- 8) CTA xanh ph·ªß to√†n trang d∆∞·ªõi c√πng -->
  <section class="card footer-cta" id="ctaBottom">
    <h3 style="margin:0 0 6px" data-i18n="cta_big_h"></h3>
    <div data-i18n="cta_big_p"></div>
    <div class="row" style="margin-top:8px">
      <a class="btn" href="#supergate" data-i18n="cta_unlock"></a>
      <a class="btn out" id="cta_binance2" target="_blank" rel="noopener"></a>
      <a class="btn out" id="cta_algos2" target="_blank" rel="noopener"></a>
      <button class="btn out" id="shareMine" data-i18n="share_my_link"></button>
    </div>
  </section>

  <button class="pill" id="goTop" style="position:fixed;left:12px;bottom:80px;z-index:9">‚Üë Top</button>
  <div class="footer">¬© <span id="year"></span> LightUnfold ‚Ä¢ <span id="autoLbl"></span></div>
</div>

<!-- Share floating -->
<div class="sharebar" style="position:fixed;right:12px;bottom:12px;display:flex;gap:8px;background:var(--card);border:1px solid var(--line);border-radius:12px;padding:8px;z-index:9">
  <a id="sh_tg" target="_blank" title="Share Telegram">üì£</a>
  <a id="sh_x"  target="_blank" title="Share X/Twitter">ùïè</a>
  <a id="sh_fb" target="_blank" title="Share Facebook">f</a>
  <a id="sh_in" target="_blank" title="Share LinkedIn">in</a>
</div>

<!-- Chat 24/7 -->
<button class="btn chatfab" id="openChat">üß† Chat AI 24/7</button>
<div class="chatwin" id="chat">
  <div class="chathead"><b id="chatTitle"></b>
    <div>
      <button class="btn out" id="minChat">‚Äî</button>
      <button class="btn" id="closeChat">‚úñ</button>
    </div>
  </div>
  <div class="chatbody" id="chatBody"></div>
  <div style="padding:0 10px" id="chipBar"></div>
  <div class="chatinput">
    <input id="chatIn" class="input" placeholder="">
    <button class="btn" id="chatSend"></button>
  </div>
</div>

<!-- Modal Premium Data -->
<div id="dataModal" class="modal" aria-hidden="true">
  <div class="box">
    <header>
      <b id="modalTitle"></b>
      <div class="row">
        <button class="btn out" id="dlData">‚≠≥</button>
        <button class="btn" id="closeData">‚úñ</button>
      </div>
    </header>
    <pre id="dataPre" style="flex:1;margin:0;padding:12px;overflow:auto;background:#0b0f13"></pre>
  </div>
</div>

<script>
/* ====== FLAGS ====== */
const USE_LIVE=false; // khi g·∫Øn API th·∫≠t, ƒë·∫∑t true
/* ====== HELPERS ====== */
const $=s=>document.querySelector(s), $$=s=>document.querySelectorAll(s);
const fmt=n=>Number(n||0).toLocaleString(undefined,{maximumFractionDigits:8});
const qrlink=t=>`https://api.qrserver.com/v1/create-qr-code/?size=320x320&data=${encodeURIComponent(t)}`;
const j=async(u)=>{try{const r=await fetch(u,{cache:'no-store'});if(!r.ok) throw 0;return await r.json()}catch(_){return null}};
function setTheme(m){document.documentElement.classList.toggle('light',m==='light');localStorage.setItem('theme',m)}
setTheme(localStorage.getItem('theme')||'dark'); $('#theme').onclick=()=>setTheme(document.documentElement.classList.contains('light')?'dark':'light');
$('#year').textContent=new Date().getFullYear(); $('#goTop').onclick=()=>window.scrollTo({top:0,behavior:'smooth'});

/* ====== I18N FULL ====== */
const I18N={
 vi:{
  tagline:"Web3 c·ªßa b·∫°n ‚Äì Tr·ª£ l√Ω t√†i ch√≠nh AI 24/7 ‚Ä¢ Cho ƒëi 70% ‚Ä¢ Top 3 Premium m·ªü kh√≥a t·∫°i ch·ªó",
  quote:"‚ÄúBi·∫øt s·ªõm ‚Ä¢ Quy·∫øt ƒë·ªãnh s·ªõm ‚Ä¢ L·ª£i th·∫ø s·ªõm.‚Äù",
  hero_blurb:"N∆°i h·ªôi t·ª•: Kho√° h·ªçc tinh g·ªçn, Ph√¢n t√≠ch Crypto realtime, AI h·ªèi ƒë√°p & C∆° h·ªôi ƒë·∫ßu t∆∞ ƒë·∫ßu b·∫£ng.",
  kpi_opps:"C∆° h·ªôi", kpi_upd:"C·∫≠p nh·∫≠t", kpi_live:"ƒêang xem", kpi_rev:"Doanh thu",
  h_top3:"‚≠ê Top 3 Token ti·ªÅm nƒÉng NH·∫§T (Premium)",
  h_free_tokens:"üìä Token ch·ªçn l·ªçc mi·ªÖn ph√≠ ‚Äî c·∫≠p nh·∫≠t li√™n t·ª•c",
  h_academy:"üìö H·ªçc vi·ªán ‚Äî S√°ch s·ªë & Kho√° h·ªçc",
  h_hot:"üî• C∆° h·ªôi n·ªïi b·∫≠t",
  h_packs:"üß∞ G√≥i Premium (9$ / 19$ / 29$)",
  h_gate:"üîì C·ª≠a m·ªü kho√° (SuperGate)",
  addr_id:"ƒê·ªãa ch·ªâ/ID", min_lbl:"T·ªëi thi·ªÉu", copy_addr:"Sao ch√©p ƒë·ªãa ch·ªâ",
  choose_pack:"Ch·ªçn g√≥i", enter_code:"Nh·∫≠p m√£ m·ªü kho√° (sau khi thanh to√°n)", unlock_btn:"M·ªü kho√°", remember_btn:"Nh·ªõ m√£",
  unlock_hint:"Sau khi m·ªü kho√°, n·ªôi dung premium xu·∫•t hi·ªán ngay b√™n d∆∞·ªõi. M√£ ƒë∆∞·ª£c l∆∞u c·ª•c b·ªô tr√™n thi·∫øt b·ªã.",
  unlocked:"‚úî ƒê√É M·ªû KHO√Å", relock:"Kho√° l·∫°i",
  cta_unlock:"M·ªü kho√° ngay",
  h_partners:"ü§ù ƒê·ªëi t√°c chi·∫øn l∆∞·ª£c",
  algos_title:"AI giao d·ªãch th·ª±c chi·∫øn",
  algos_desc:"ƒê·ªÉ m√°y h·ªçc g·ª£i √Ω chi·∫øn l∆∞·ª£c ‚Äî b·∫°n t·∫≠p trung k·ª∑ lu·∫≠t. C·∫£nh b√°o realtime ‚Ä¢ Backtest nhanh ‚Ä¢ K·∫øt n·ªëi nhi·ªÅu s√†n.",
  algos_btn:"D√πng th·ª≠ AlgosOne ‚Üó",
  binance_title:"b∆∞·ªõc kh·ªüi ƒë·∫ßu th√¥ng minh",
  binance_desc:"Giao d·ªãch n∆°i thanh kho·∫£n s√¢u nh·∫•t. Ph√≠ c·∫°nh tranh ‚Ä¢ Earn/Futures/Options ‚Ä¢ Launchpad/Launchpool ‚Ä¢ B·∫£o m·∫≠t & API m·∫°nh.",
  binance_btn:"M·ªü t√†i kho·∫£n mi·ªÖn ph√≠ ‚Üó",
  cta_big_h:"üöÄ C∆° h·ªôi kh√¥ng ch·ªù ‚Äî b·∫°n c≈©ng ƒë·ª´ng ch·ªù!",
  cta_big_p:"Ch·ªâ c·∫ßn m·ªü kho√° ho·∫∑c ƒëƒÉng k√Ω t√†i kho·∫£n h√¥m nay, b·∫°n b∆∞·ªõc v√†o h·ªá AI t√†i ch√≠nh 24/7 ‚Äî n∆°i m·ªçi nh·ªãp th·ªã tr∆∞·ªùng trong t·∫ßm tay.",
  share_my_link:"Chia s·∫ª li√™n k·∫øt c·ªßa t√¥i",
  chat_title:"AI T√†i ch√≠nh 24/7", chat_ph:"H·ªèi token, chi·∫øn l∆∞·ª£c, m·ªü kho√°‚Ä¶", chat_send:"G·ª≠i",
  scan_data:"qu√©t: data", scan_fb:"qu√©t: live",
  free_open:"M·ªü bi·ªÉu ƒë·ªì ‚Üó", free_ai:"AI ph√¢n t√≠ch nhanh",
  data_title:"D·ªØ li·ªáu Premium", dl:"T·∫£i",
  auto:"T·ª± ƒë·ªông 24/7",
  gate_pitch:"Mu·ªën xem Top 3 d·∫´n ƒë·∫ßu & kho ki·∫øn th·ª©c tinh g·ªçn? Thanh to√°n nh·ªè ‚Üí nh·∫≠n m√£ ‚Üí m·ªü kho√° t·∫°i ch·ªó."
 },
 en:{
  tagline:"Your Web3 ‚Äî 24/7 Finance AI ‚Ä¢ Give 70% Free ‚Ä¢ Top-3 Premium unlock on-page",
  quote:"‚ÄúKnow early ‚Ä¢ Decide early ‚Ä¢ Edge early.‚Äù",
  hero_blurb:"Where crisp courses, realtime crypto analytics, Q&A AI and early opportunities meet.",
  kpi_opps:"Opportunities", kpi_upd:"Updated", kpi_live:"Live", kpi_rev:"Revenue",
  h_top3:"‚≠ê Top 3 Highest-Potential Tokens (Premium)",
  h_free_tokens:"üìä Curated Free Tokens ‚Äî continuously updated",
  h_academy:"üìö Academy ‚Äî eBooks & Courses",
  h_hot:"üî• Hot opportunities",
  h_packs:"üß∞ Premium bundles ($9 / $19 / $29)",
  h_gate:"üîì Unlock Gate (SuperGate)",
  addr_id:"Address/ID", min_lbl:"Minimum", copy_addr:"Copy address",
  choose_pack:"Choose bundle", enter_code:"Enter unlock code (after payment)", unlock_btn:"Unlock", remember_btn:"Remember",
  unlock_hint:"After unlocking, premium content appears below. Code is stored locally on device.",
  unlocked:"‚úî UNLOCKED", relock:"Lock again",
  cta_unlock:"Unlock now",
  h_partners:"ü§ù Strategic partners",
  algos_title:"battle-tested AI trading",
  algos_desc:"Let ML suggest strategies ‚Äî you execute with discipline. Realtime alerts ‚Ä¢ Fast backtests ‚Ä¢ Multi-exchange.",
  algos_btn:"Try AlgosOne ‚Üó",
  binance_title:"smart starting point",
  binance_desc:"Trade where the deepest liquidity lives. Competitive fees ‚Ä¢ Earn/Futures/Options ‚Ä¢ Launchpad/Launchpool ‚Ä¢ Security & robust API.",
  binance_btn:"Open free account ‚Üó",
  cta_big_h:"üöÄ Opportunity won‚Äôt wait ‚Äî neither should you!",
  cta_big_p:"Unlock or open a free account today to step into the 24/7 finance AI ‚Äî every market beat in your hand.",
  share_my_link:"Share my referral link",
  chat_title:"24/7 Finance AI", chat_ph:"Ask tokens, strategy, unlock‚Ä¶", chat_send:"Send",
  scan_data:"scan: data", scan_fb:"scan: live",
  free_open:"Open chart ‚Üó", free_ai:"Quick AI take",
  data_title:"Premium Data", dl:"Download",
  auto:"Always-on 24/7",
  gate_pitch:"Want today‚Äôs top-3 leaders & a condensed knowledge vault? Small payment ‚Üí receive code ‚Üí unlock in-place."
 }
};
let LANG=(localStorage.getItem('lang')||navigator.language||'vi').toLowerCase().startsWith('vi')?'vi':'en';
function t(key){return I18N[LANG][key]||key}
function applyStatic(){
  $('#tagline').textContent=t('tagline'); $('#quote').textContent=t('quote'); $('#hero_blurb').textContent=t('hero_blurb');
  $('[data-i18n="kpi_opps"]').textContent=t('kpi_opps');
  $('[data-i18n="kpi_upd"]').textContent=t('kpi_upd');
  $('[data-i18n="kpi_live"]').textContent=t('kpi_live');
  $('[data-i18n="kpi_rev"]').textContent=t('kpi_rev');
  $('[data-i18n="h_top3"]').textContent=t('h_top3');
  $('[data-i18n="h_free_tokens"]').textContent=t('h_free_tokens');
  $('[data-i18n="h_academy"]').textContent=t('h_academy');
  $('[data-i18n="h_hot"]').textContent=t('h_hot');
  $('[data-i18n="h_packs"]').textContent=t('h_packs');
  $('[data-i18n="h_gate"]').textContent=t('h_gate');
  $('[data-i18n="addr_id"]').textContent=t('addr_id');
  $('[data-i18n="min_lbl"]').textContent=t('min_lbl');
  $('#copyAddr').textContent=t('copy_addr');
  $('[data-i18n="choose_pack"]').textContent=t('choose_pack');
  $('[data-i18n="enter_code"]').textContent=t('enter_code');
  $('#doUnlock').textContent=t('unlock_btn');
  $('#remember').textContent=t('remember_btn');
  $('#unlockedLbl').textContent=t('unlocked');
  $('#relock').textContent=t('relock');
  $('[href="#supergate"]').textContent=t('cta_unlock');
  $('[data-i18n="h_partners"]').textContent=t('h_partners');
  $('[data-i18n="algos_title"]').textContent=t('algos_title');
  $('[data-i18n="algos_desc"]').textContent=t('algos_desc');
  $('#algosBtn').textContent=t('algos_btn');
  $('[data-i18n="binance_title"]').textContent=t('binance_title');
  $('[data-i18n="binance_desc"]').textContent=t('binance_desc');
  $('#binanceBtn').textContent=t('binance_btn');
  $('[data-i18n="cta_big_h"]').textContent=t('cta_big_h');
  $('[data-i18n="cta_big_p"]').textContent=t('cta_big_p');
  $('#shareMine').textContent=t('share_my_link');
  $('#chatTitle').textContent=t('chat_title');
  $('#chatIn').placeholder=t('chat_ph');
  $('#chatSend').textContent=t('chat_send');
  $('#modalTitle').textContent=t('data_title');
  $('#dlData').title=t('dl');
  $('#autoLbl').textContent=t('auto');
  $('#scanMode').textContent=t('scan_data');
  $('#gatePitch').textContent=t('gate_pitch');
  // CTAs
  const bnv=LANG==='vi'?'https://www.binance.com/vi/register?ref=GRO_20338_9V44N':'https://www.binance.com/en/register?ref=GRO_20338_9V44N';
  const alg='https://algosone.page.link/MbtR';
  $('#cta_binance').textContent=t('binance_btn'); $('#cta_binance').href=bnv;
  $('#cta_algos').textContent=t('algos_btn'); $('#cta_algos').href=alg;
  $('#cta_binance2').textContent=t('binance_btn'); $('#cta_binance2').href=bnv;
  $('#cta_algos2').textContent=t('algos_btn'); $('#cta_algos2').href=alg;
  // placeholders
  $('#unlockCode').placeholder = LANG==='vi'?'Nh·∫≠p m√£‚Ä¶':'Enter code‚Ä¶';
  $('#txhash').placeholder = LANG==='vi'?'(Tu·ª≥ ch·ªçn) TX hash / ghi ch√∫':'(Optional) TX hash / note';
}
$('#lang').onclick=()=>{LANG=LANG==='vi'?'en':'vi';localStorage.setItem('lang',LANG);applyStatic();paintBundles();paintPremium();renderAll(LAST_ITEMS)};

/* ====== Config & Content ====== */
const CFG={
 site:{brand:"LightUnfold ‚Ä¢ UltraMaster V20‚àû",ens:"lightunfold.eth",
  payments:{chains:[
    {name:"ETH (EVM)",address:"0x54E15A7b6d4213beE87800432A151d794638E3C2",explorer:"https://etherscan.io/address/0x54E15A7b6d4213beE87800432A151d794638E3C2",min:0.0005},
    {name:"USDT (ERC20)",address:"0x5da80d0f7e2df3cb0aa73d6a942bbe36b046b8f0",explorer:"https://etherscan.io/token/USDT?a=0x5da80d0f7e2df3cb0aa73d6a942bbe36b046b8f0",min:5},
    {name:"MoMo",address:"0567892030"},
    {name:"Vietcombank",address:"9567892030"},
    {name:"PayPal",address:"vumumabada@gmail.com"}
  ]}},
 secrets:{unlock_code:"23061988"},
 store:{
  bundles:[
    {id:"p9", title:"Starter Alpha", price:9, desc_vi:"Chi·∫øn l∆∞·ª£c n·∫°p nhanh, 1-2 thi·∫øt l·∫≠p/ng√†y.", desc_en:"Quick setups, 1‚Äì2/day."},
    {id:"p19",title:"Swing Pro",    price:19,desc_vi:"M·∫´u h√¨nh & d√≤ng ti·ªÅn theo tu·∫ßn.",         desc_en:"Patterns & flows (weekly)."},
    {id:"p29",title:"Master Flow",  price:29,desc_vi:"D√≤ng v·ªën ETF/BTC & Altseason Radar.",      desc_en:"ETF/BTC flows & Altseason radar."}
  ],
  premium:[
    {title:"Alpha Feed Pro",price:19,desc_vi:"Tin alpha tr·ªÖ ms, l·ªçc nhi·ªÖu ƒëa k√™nh.",desc_en:"Millisecond alpha feed, multi-source filters.", bullets_vi:["D√≤ng ti·ªÅn b·∫•t th∆∞·ªùng","Ngu·ªìn ƒëa k√™nh","B·ªô l·ªçc nhi·ªÖu"], bullets_en:["Anomalous flows","Multi-source","Noise filter"]},
    {title:"Deal Flow Private",price:29,desc_vi:"Deal/seed ƒëang m·ªü ‚Äî ƒëi·ªÅu ki·ªán & ∆∞u ti√™n.",desc_en:"Open deal/seed ‚Äî terms & priority.", bullets_vi:["ƒêi·ªÅu ki·ªán","∆Øu ti√™n th·ªùi gian"], bullets_en:["Terms","Time priority"]}
  ],
  edu:[
    {title:"Crypto 101",price:0, tag_vi:"Mi·ªÖn ph√≠",tag_en:"Free",
     desc_vi:"V√≠ & b·∫£o m·∫≠t, chu k·ª≥, qu·∫£n tr·ªã v·ªën. 70% mi·ªÖn ph√≠ ‚Äî m·ªü kho√° ph·∫ßn chuy√™n s√¢u.",
     desc_en:"Wallet & security, cycles, risk. 70% free ‚Äî unlock advanced parts."},
    {title:"DeFi Mastery",price:10, tag_vi:"N√¢ng cao",tag_en:"Advanced",
     desc_vi:"Yield ‚Ä¢ Lending ‚Ä¢ Perp ‚Ä¢ Case study ‚Äî l·ªô tr√¨nh √°p d·ª•ng th·ª±c chi·∫øn.",
     desc_en:"Yield ‚Ä¢ Lending ‚Ä¢ Perp ‚Ä¢ Case studies ‚Äî battle-tested curriculum."},
    {title:"Risk & Psychology",price:19, tag_vi:"Chuy√™n s√¢u",tag_en:"Deep dive",
     desc_vi:"K·ª∑ lu·∫≠t ‚Ä¢ RR‚â•1:2 ‚Ä¢ Nh·∫≠t k√Ω giao d·ªãch ‚Ä¢ √în t·∫≠p sai l·∫ßm th∆∞·ªùng g·∫∑p.",
     desc_en:"Discipline ‚Ä¢ RR‚â•1:2 ‚Ä¢ Journaling ‚Ä¢ Mistake patterns."}
  ]
 }};
$('#brand').textContent=CFG.site.brand; $('#ens').textContent=CFG.site.ens;

/* ===== ViralShare 2.0 ===== */
(function ViralShare(){
  const U = new URL(location.href);
  const refIn=U.searchParams.get('ref');
  const peer=localStorage.getItem('peer_id')||Math.random().toString(36).slice(2);
  if(!localStorage.getItem('peer_id')) localStorage.setItem('peer_id',peer);
  if(refIn) localStorage.setItem('ref_by',refIn);
  const base=location.origin+location.pathname;
  const myRef=`${base}?ref=${peer}&utm_source=share&utm_medium=viral&utm_campaign=ultramaster`;
  localStorage.setItem('my_ref',myRef);
  const tT=encodeURIComponent(document.title), u=encodeURIComponent(myRef);
  $('#sh_tg').href=`https://t.me/share/url?url=${u}&text=${tT}`;
  $('#sh_x').href =`https://twitter.com/intent/tweet?text=${tT}&url=${u}`;
  $('#sh_fb').href=`https://www.facebook.com/sharer/sharer.php?u=${u}`;
  $('#sh_in').href=`https://www.linkedin.com/sharing/share-offsite/?url=${u}`;
  $('#shareMine').onclick=async()=>{try{if(navigator.share){await navigator.share({title:document.title,text:'UltraMaster V20‚àû',url:myRef});}else{await navigator.clipboard.writeText(myRef);alert(LANG==='vi'?'ƒê√£ sao ch√©p li√™n k·∫øt!':'Link copied!');}}catch(_){}}; 
})();

/* ===== BTC/ETH/USDT ticker ===== */
async function tick3(){
  if(USE_LIVE){
    try{
      const ids='bitcoin,ethereum,tether';
      const r=await j('https://api.coingecko.com/api/v3/simple/price?ids='+ids+'&vs_currencies=usd&include_24hr_change=true');
      if(!r) return;
      const m=[{k:'BTC',p:r.bitcoin?.usd,c:r.bitcoin?.usd_24h_change},
               {k:'ETH',p:r.ethereum?.usd,c:r.ethereum?.usd_24h_change},
               {k:'USDT',p:r.tether?.usd,c:r.tether?.usd_24h_change}];
      $('#ticker3').innerHTML=m.map(o=>`<span class="chip">${o.k} $${fmt(o.p)} <b class="${(o.c||0)>=0?'ok':'bad'}">${(o.c||0).toFixed(2)}%</b></span>`).join('');
    }catch(_){}
  }else{
    $('#ticker3').innerHTML=['BTC $67,234 +1.24%','ETH $3,214 -0.84%','USDT $1.00 +0.02%']
      .map(s=>`<span class="chip">${s}</span>`).join('');
  }
}

/* ===== Market data: free + pro ===== */
let LAST_ITEMS=[];
async function fetchLive(){
  if(USE_LIVE){
    const latest=await j('data/latest.json');
    if(latest && Array.isArray(latest.items)){ renderAll(latest.items); return; }
    try{
      const cg=await j('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=volume_desc&per_page=60&page=1&price_change_percentage=1h,24h,7d');
      const items=(cg||[]).map(c=>({source:"coingecko",symbol:(c.symbol||"").toUpperCase(),name:c.name,price:+c.current_price||0,
        ch24h:+c.price_change_percentage_24h_in_currency||0,vol24h:+c.total_volume||0,
        mcap:+c.market_cap||0, link:`https://www.coingecko.com/en/coins/${c.id}`,
        score:(+c.price_change_percentage_1h_in_currency||0)*0.4+(+c.price_change_percentage_24h_in_currency||0)*0.35+(+c.price_change_percentage_7d_in_currency||0)*0.25+Math.log10((+c.total_volume||1))}));
      const best={}; for(const it of items){const k=it.symbol; if(!best[k]||it.score>best[k].score) best[k]=it;}
      LAST_ITEMS=Object.values(best).sort((a,b)=>b.score-a.score).slice(0,20);
      renderAll(LAST_ITEMS);
    }catch(_){}
  }else{
    // Demo data (offline)
    LAST_ITEMS=[
      {symbol:'BTC',name:'Bitcoin',price:67234,ch24h:1.24,vol24h:22830400000,score:12.4,link:'#'},
      {symbol:'ETH',name:'Ethereum',price:3214,ch24h:-0.84,vol24h:10320000000,score:9.1,link:'#'},
      {symbol:'SOL',name:'Solana',price:149.2,ch24h:2.4,vol24h:5200000000,score:8.8,link:'#'},
      {symbol:'FET',name:'Fetch.ai',price:2.31,ch24h:6.5,vol24h:890000000,score:7.9,link:'#'},
      {symbol:'TAO',name:'Bittensor',price:485,ch24h:3.1,vol24h:410000000,score:7.5,link:'#'},
      {symbol:'INJ',name:'Injective',price:28.4,ch24h:-1.2,vol24h:620000000,score:7.2,link:'#'},
      {symbol:'ARB',name:'Arbitrum',price:1.09,ch24h:4.3,vol24h:350000000,score:6.9,link:'#'},
      {symbol:'TIA',name:'Celestia',price:6.7,ch24h:5.8,vol24h:280000000,score:6.5,link:'#'},
      {symbol:'SEI',name:'Sei',price:0.45,ch24h:3.4,vol24h:210000000,score:6.2,link:'#'},
      {symbol:'PYTH',name:'Pyth Network',price:0.36,ch24h:2.1,vol24h:190000000,score:6.0,link:'#'}
    ];
    renderAll(LAST_ITEMS);
  }
}
function renderAll(items){
  $('#kOpps').textContent=items.length; $('#kUpd').textContent=new Date().toLocaleTimeString();
  $('#ticker').innerHTML=items.slice(0,12).map(x=>`<span class="tag">${x.symbol}: $${fmt(x.price)} (${(x.ch24h||0).toFixed(2)}%)</span>`).join('')||'‚Äî';
  // hot list
  $('#opps').innerHTML=items.slice(0,10).map(x=>{
    const ch=x.ch24h||0,pct=`${ch>=0?'+':''}${ch.toFixed(2)}%`;
    return `<div class="item"><div class="score">+${(x.score||0).toFixed(2)}</div>
      <div style="flex:1;min-width:0">
        <div class="row" style="justify-content:space-between;gap:8px">
          <div><b>${x.symbol}</b> ¬∑ <span class="muted">${x.name||''}</span></div>
          <a class="btn out" target="_blank" rel="noopener" href="${x.link||'#'}">${LANG==='vi'?'Chi ti·∫øt ‚Üó':'Details ‚Üó'}</a></div>
        <div class="row" style="gap:8px">
          <span class="tag">${LANG==='vi'?'Gi√°':'Price'}: $${fmt(x.price||0)}</span>
          <span class="tag ${ch>=0?'ok':'bad'}">24h: ${pct}</span>
          <span class="tag">Vol: $${fmt(x.vol24h||0)}</span>
        </div></div></div>`;
  }).join('');

  // Free curated
  const free = items.slice(0,7);
  $('#tokenFree').innerHTML=free.map(x=>{
    const c=x.ch24h||0, rr=c>=0?'ok':'bad';
    return `<div class="shop-card">
      <h4>${x.symbol} ‚Äî ${x.name||''}</h4>
      <div class="note">${LANG==='vi'?'Gi√°':'Price'}: $${fmt(x.price)} ¬∑ <b class="${rr}">${c.toFixed(2)}%</b> ¬∑ Vol: $${fmt(x.vol24h)}</div>
      <div class="row" style="margin-top:8px">
        <a class="btn out" target="_blank" rel="noopener" href="${x.link||'#'}">${t('free_open')}</a>
        <button class="btn out" onclick="aiHint('${x.symbol}')">${t('free_ai')}</button>
      </div>
    </div>`;
  }).join('');

  // Premium Top 3 (masked)
  const pro = items.slice(0,3);
  $('#tokenPro').innerHTML=pro.map((x,i)=>{
    return `<div class="shop-card">
      <h4>‚≠ê #${i+1} ‚Äî ${LANG==='vi'?'Token ti·ªÅm nƒÉng nh·∫•t':'Highest-potential token'}</h4>
      <div class="note">${LANG==='vi'?'M·ªü kho√° ƒë·ªÉ xem:':'Unlock to view:'} <b>${x.symbol}</b> ‚Ä¢ ${LANG==='vi'?'Gi√°/Vol/7d + chi·∫øn l∆∞·ª£c v√†o/ra an to√†n':'Price/Vol/7d + safe in/out plan'}.</div>
      <a class="btn" href="#supergate">${t('cta_unlock')}</a>
    </div>`;
  }).join('');
}

/* ===== Bundles + Premium blocks ===== */
function paintBundles(){
  $('#bundles').innerHTML=CFG.store.bundles.map(b=>{
    const desc = LANG==='vi'?b.desc_vi:b.desc_en;
    return `<div class="shop-card">
      <h4>${b.title}</h4>
      <div class="note">${desc}</div>
      <div class="row" style="margin-top:8px">
        <button class="btn" onclick="document.getElementById('unlockCode').focus()">${t('cta_unlock')}</button>
        <span class="badge">$${b.price}</span>
      </div>
    </div>`;
  }).join('');
  $('#bundleSel').innerHTML=CFG.store.bundles.map(b=>`<option value="${b.id}">${b.title} ‚Äî $${b.price}</option>`).join('');
}
function paintPremium(){
  const P=CFG.store.premium||[];
  $('#premium').innerHTML=P.map(p=>{
    const desc = LANG==='vi'?p.desc_vi:p.desc_en;
    const bullets = (LANG==='vi'?p.bullets_vi:p.bullets_en)||[];
    return `<div class="shop-card"><h4>${p.title} ‚Äî $${p.price}</h4>
      <div class="note">${desc}</div>
      ${bullets.length?`<ul>${bullets.map(x=>`<li>${x}</li>`).join('')}</ul>`:""}
      <button class="btn out" onclick="openDataModal()">${LANG==='vi'?'Xem d·ªØ li·ªáu':'Open data'} ‚Üó</button>
    </div>`;
  }).join('');
}

/* ===== Payments: QR + tabs + copy ===== */
const pays=CFG.site.payments.chains;
let activePay=0;
function paintPay(){
  const first=pays[activePay]||pays[0];
  $('#qr').src=qrlink(first.address); $('#payAddr').textContent=first.address;
  $('#minHint').textContent = (()=>{
    const mETH=pays.find(p=>/ETH/i.test(p.name))?.min||0.0005;
    const mUSDT=pays.find(p=>/USDT/i.test(p.name))?.min||5;
    return `ETH ‚â• ${mETH}, USDT ‚â• $${mUSDT}`;
  })();
  $('#payTabs').innerHTML=pays.map((c,i)=>`<button class="btn ${i===activePay?'':'out'}" onclick="switchPay(${i})">${c.name}</button>`).join('');
}
function switchPay(i){activePay=i; paintPay(); flash('#copyMsg', LANG==='vi'?'ƒê√£ chuy·ªÉn ph∆∞∆°ng th·ª©c.':'Method switched.')}
$('#copyAddr').onclick=async()=>{try{await navigator.clipboard.writeText($('#payAddr').textContent.trim()); flash('#copyMsg', LANG==='vi'?'ƒê√£ sao ch√©p!':'Copied!')}catch(_){flash('#copyMsg','‚Ä¶')}};
function flash(sel,txt){const n=$(sel); n.textContent=txt; setTimeout(()=>n.textContent='',1600)}

/* ===== Paywall ===== */
const SECRET=String(CFG.secrets.unlock_code||'23061988');
function gate(open){$('#opened').classList.toggle('hidden',!open);}
(function bindPaywall(){
  const saved=localStorage.getItem('unlocked_code')||'';
  if(saved===SECRET){gate(true); paintPremium(); const th=localStorage.getItem('tx_hash'); if(th) $('#uMsg').innerHTML='<span class="ok">TX: '+th+'</span>';}
  $('#doUnlock').onclick=()=>{const code=$('#unlockCode').value.trim(),tx=$('#txhash').value.trim();
    if(code===SECRET){gate(true); paintPremium(); $('#uMsg').innerHTML='<span class="ok">'+t('unlocked')+'</span>'; if(tx) localStorage.setItem('tx_hash',tx); localStorage.setItem('unlocked_code',code);}
    else $('#uMsg').innerHTML='<span class="bad">'+(LANG==='vi'?'M√£ kh√¥ng ƒë√∫ng.':'Invalid code.')+'</span>';};
  $('#remember').onclick=()=>{const c=$('#unlockCode').value.trim(); if(c){localStorage.setItem('unlocked_code',c); $('#uMsg').textContent=LANG==='vi'?'ƒê√£ l∆∞u tr√™n thi·∫øt b·ªã.':'Saved on device.'}};
  $('#relock').onclick=()=>{localStorage.removeItem('unlocked_code'); gate(false);};
})();

/* ===== AI Chat ===== */
function addBubble(txt, who='ai'){
  const b=document.createElement('div'); b.className='bubble '+(who==='me'?'me':'ai'); b.innerHTML=txt; $('#chatBody').appendChild(b); $('#chatBody').scrollTop=1e6;
}
function aiHint(sym){
  const text = LANG==='vi'
    ? `AI g·ª£i √Ω nhanh cho <b>${sym}</b>: ∆Øu ti√™n qu·∫£n tr·ªã r·ªßi ro (r·ªßi ro 1‚Äì2%/l·ªánh), ch·ªù x√°c nh·∫≠n kh·ªëi l∆∞·ª£ng, ƒë·∫∑t stop c·ª©ng. Mu·ªën xem Top 3 & k·∫ø ho·∫°ch v√†o/ra? ‚Üí <a href="#supergate">${t('cta_unlock')}</a>`
    : `Quick AI take on <b>${sym}</b>: Risk 1‚Äì2%/trade, wait for volume confirmation, hard stop. Want Top-3 & in/out plan? ‚Üí <a href="#supergate">${t('cta_unlock')}</a>`;
  addBubble(text,'ai');
  $('#openChat').click();
}
(function chatInit(){
  $('#chatTitle').textContent=t('chat_title'); $('#chatIn').placeholder=t('chat_ph'); $('#chatSend').textContent=t('chat_send');
  $('#openChat').onclick=()=>{$('#chat').style.display='flex'; if(!$('#chatBody').dataset.hi){addBubble(LANG==='vi'?'Ch√†o b·∫°n! 70% n·ªôi dung mi·ªÖn ph√≠, Top 3 m·ªü kho√° t·∫°i SuperGate.':'Hi! 70% content is free, Top-3 unlock at SuperGate.'); $('#chatBody').dataset.hi=1;}};
  $('#closeChat').onclick=()=>{$('#chat').style.display='none'};
  $('#minChat').onclick=()=>{$('#chat').style.height=$('#chat').style.height==='56px'?'':'56px'};
  $('#chatSend').onclick=()=>{const v=$('#chatIn').value.trim(); if(!v) return; addBubble(v,'me'); $('#chatIn').value='';
    setTimeout(()=>addBubble(LANG==='vi'?'M√¨nh ƒë√£ ghi nh·∫≠n. B·∫°n mu·ªën xem Top 3 hay m·ªü kho√° g√≥i 9/19/29?':'Got it. Want Top-3 or unlock 9/19/29?', 'ai'),300);
  };
})();

/* ===== Modal Premium Data (close bug fixed + ESC) ===== */
const PREMIUM_DATA={
  updated_at:new Date().toISOString(),
  alpha_feed:[
    {type:"flow", text: LANG==='vi'?"D√≤ng ti·ªÅn BTC v√†o CEX tƒÉng ‚Äî theo d√µi v√πng breakout.":"BTC flows to CEX rising ‚Äî watch breakout."},
    {type:"onchain", text: LANG==='vi'?"V√≠ c√° voi gom alt mid-cap h·ªá ETH.":"Whales accumulate ETH-ecosystem mid-caps."},
    {type:"macro", text: LANG==='vi'?"ETF spot ti·∫øp t·ª•c inflow tu·∫ßn n√†y.":"ETF spot sees continued inflows this week."}
  ],
  deals:[{name:"Seed/Private-DeFiX", note: LANG==='vi'?"Allocation nh·ªè, vesting 12m.":"Small allocation, 12m vesting."}]
};
function openDataModal(){
  $('#dataPre').textContent=JSON.stringify(PREMIUM_DATA,null,2);
  $('#dataModal').classList.add('on'); $('#dataModal').setAttribute('aria-hidden','false');
}
$('#openData').onclick=openDataModal;
$('#closeData').onclick=()=>{$('#dataModal').classList.remove('on'); $('#dataModal').setAttribute('aria-hidden','true');}
$('#dataModal').addEventListener('click',e=>{ if(e.target.id==='dataModal') $('#closeData').click(); });
window.addEventListener('keydown',e=>{ if(e.key==='Escape') $('#closeData').click(); });
$('#dlData').onclick=()=>{const blob=new Blob([$('#dataPre').textContent],{type:'application/json'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='premium.json'; a.click(); URL.revokeObjectURL(a.href); };

/* ===== Live counters & Viral peers ===== */
(function peers(){
  const k='umv20_peers'; const now=Date.now(), ttl=25e3; const id=localStorage.getItem('peer_id')||Math.random().toString(36).slice(2); localStorage.setItem('peer_id',id);
  const raw=localStorage.getItem(k); let list=raw?JSON.parse(raw):[]; list=list.filter(x=>now-x.t<ttl); const me=list.find(x=>x.id===id); if(me) me.t=now; else list.push({id,t:now});
  localStorage.setItem(k,JSON.stringify(list)); $('#kLive').textContent=list.length; setTimeout(peers,4000);
})();

/* ===== Boot ===== */
function paintCTAs(){ // m√†u v√†ng Binance n·ªïi h∆°n
  document.querySelectorAll('#binanceBtn,#cta_binance,#cta_binance2').forEach(a=>a.style.background='#f0b90b');
}
function cascadeGreen(){ // ph·ªß s·∫Øc xanh phong th·ªßy xu·ªëng c√°c √¥ ƒë·∫ßu m·ª•c
  document.querySelectorAll('section.card h3').forEach(h=>{h.style.color='#b8ffd9'});
}
async function boot(){
  applyStatic(); paintCTAs(); cascadeGreen();
  tick3(); setInterval(tick3, 9000);
  await fetchLive(); setInterval(fetchLive, 60000);
  paintBundles(); paintPremium(); paintPay();
  $('#scanMode').textContent = USE_LIVE ? t('scan_fb') : t('scan_data');
}
boot();

/* ===== THEME LABEL ===== */
$('#theme').addEventListener('click',()=>{ /* theme toggled by handler */ });

</script>
</body>
</html>
